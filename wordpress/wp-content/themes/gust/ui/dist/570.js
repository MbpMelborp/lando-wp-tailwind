"use strict";(self.webpackChunkgust_builder=self.webpackChunkgust_builder||[]).push([[570],{77570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return t=>{let r=function(e){let t=null;return{get:r=>(t=t||e(),t.get(r)),has:r=>(t=t||e(),t.has(r))}}((()=>function(e,t){let r=new Map,n=t.layerOrder.user>>4n;return e.walkRules(((e,t)=>{for(let t of h(e)){var o;if(void 0!==(null===(o=t.raws.tailwind)||void 0===o?void 0:o.layer))return}let l=function(e){for(let t of h(e))if(e!==t){if("root"===t.type)break;e=y(t,{nodes:[e]})}return e}(e);for(let o of u(e)){let e=r.get(o)||[];r.set(o,e),e.push([{layer:"user",sort:BigInt(t)+n,important:!1},l])}})),r}(t,e)));m(t,e,r)}};var n=i(r(96195)),o=i(r(75276)),l=r(5225),a=i(r(71255)),s=i(r(56203));function i(e){return e&&e.__esModule?e:{default:e}}function u(e){let t=new Map;n.default.root({nodes:[e.clone()]}).walkRules((e=>{o.default((e=>{e.walkClasses((e=>{let r=e.parent.toString(),n=t.get(r);n||t.set(r,n=new Set),n.add(e.value)}))})).processSync(e.selector)}));let r=Array.from(t.values(),(e=>Array.from(e))),l=r.flat();return Object.assign(l,{groups:r})}let f=o.default((e=>e.nodes.map((e=>e.toString()))));function p(e){return f.transformSync(e)}function c(e,t){let r=new Set;for(let n of e)r.add(n.split(t).pop());return Array.from(r)}function d(e,t){let r=e.tailwindConfig.prefix;return"function"==typeof r?r(t):r+t}function*h(e){for(yield e;e.parent;)yield e.parent,e=e.parent}function y(e,t={}){let r=e.nodes;e.nodes=[];let n=e.clone(t);return e.nodes=r,n}function w(e,t){for(let r of e){if(t.notClassCache.has(r)||t.applyClassCache.has(r))continue;if(t.classCache.has(r)){t.applyClassCache.set(r,t.classCache.get(r).map((([e,t])=>[e,t.clone()])));continue}let e=Array.from(l.resolveMatches(r,t));0!==e.length?t.applyClassCache.set(r,e):t.notClassCache.add(r)}return t.applyClassCache}function g(e){let t=e.split(/[\s\t\n]+/g);return"!important"===t[t.length-1]?[t.slice(0,-1),!0]:[t,!1]}function m(e,t,r){let o=new Set,l=[];if(e.walkAtRules("apply",(e=>{let[t]=g(e.params);for(let e of t)o.add(e);l.push(e)})),0===l.length)return;let i=(f=[r,w(o,t)],{get:e=>f.flatMap((t=>t.get(e)||[])),has:e=>f.some((t=>t.has(e)))});var f;function h(e,t,r){let n=`.${s.default(r)}`,o=[...new Set([n,n.replace(/\\2c /g,"\\,")])],l=p(t);return p(e).map((e=>{let t=[];for(let r of l){let n=r;for(const t of o)n=n.replace(t,e);n!==r&&t.push(n)}return t.join(", ")})).join(", ")}let y=new Map;for(let e of l){let[r]=y.get(e.parent)||[[],e.source];y.set(e.parent,[r,e.source]);let[n,o]=g(e.params);if("atrule"===e.parent.type){if("screen"===e.parent.name){const t=e.parent.params;throw e.error(`@apply is not supported within nested at-rules like @screen. We suggest you write this as @apply ${n.map((e=>`${t}:${e}`)).join(" ")} instead.`)}throw e.error(`@apply is not supported within nested at-rules like @${e.parent.name}. You can fix this by un-nesting @${e.parent.name}.`)}for(let l of n){if([d(t,"group"),d(t,"peer")].includes(l))throw e.error(`@apply should not be used with the '${l}' utility`);if(!i.has(l))throw e.error(`The \`${l}\` class does not exist. If \`${l}\` is a custom class, make sure it is defined within a \`@layer\` directive.`);let n=i.get(l);r.push([l,o,n])}}for(const[e,[r,o]]of y){let l=[];for(let[a,s,i]of r){let r=[a,...c([a],t.tailwindConfig.separator)];for(let[f,p]of i){let i=u(e),d=u(p);if(d=d.groups.filter((e=>e.some((e=>r.includes(e))))).flat(),d=d.concat(c(d,t.tailwindConfig.separator)),i.some((e=>d.includes(e))))throw p.error(`You cannot \`@apply\` the \`${a}\` utility here because it creates a circular dependency.`);let y=n.default.root({nodes:[p.clone()]});y.walk((e=>{e.source=o})),("atrule"!==p.type||"atrule"===p.type&&"keyframes"!==p.name)&&y.walkRules((r=>{if(!u(r).some((e=>e===a)))return void r.remove();let n="string"==typeof t.tailwindConfig.important?t.tailwindConfig.important:null,o=void 0!==e.raws.tailwind&&n&&0===e.selector.indexOf(n)?e.selector.slice(n.length):e.selector;r.selector=h(o,r.selector,a),n&&o!==e.selector&&(r.selector=`${n} ${r.selector}`),r.walkDecls((e=>{e.important=f.important||s}))})),l.push([{...f,sort:f.sort|t.layerOrder[f.layer]},y.nodes[0]])}}let s=l.sort((([e],[t])=>a.default(e.sort-t.sort))).map((e=>e[1]));e.after(s)}for(let e of l)e.parent.nodes.length>1?e.remove():e.parent.remove();m(e,t,r)}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SzBCLE1BQU0sTUFLdkIsSUFBSUEsRUFBUW1HLEVBQVM1RixNQUFLLEVBQUUwRyxJQUFLQyxLQUFTbEcsRUFBVUksUUFBUTZGLEVBQUUxRyxLQUFPMkcsRUFBRTNHLFFBQU9rQyxLQUFLeUMsR0FBSUEsRUFBRSxLQUV6RnJGLEVBQU9zSCxNQUFNbkgsR0FFakIsSUFBSyxJQUFJb0gsS0FBVTlDLEVBRVg4QyxFQUFPdkgsT0FBT0csTUFBTWtFLE9BQVMsRUFDN0JrRCxFQUFPUixTQUdQUSxFQUFPdkgsT0FBTytHLFNBSXRCakcsRUFBYXJDLEVBQU1ELEVBQVNFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ3VzdC1idWlsZGVyLy4vbm9kZV9tb2R1bGVzL3RhaWx3aW5kY3NzLXYzL2xpYi9saWIvZXhwYW5kQXBwbHlBdFJ1bGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gZXhwYW5kQXBwbHlBdFJ1bGVzO1xudmFyIF9wb3N0Y3NzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwicG9zdGNzc1wiKSk7XG52YXIgX3Bvc3Rjc3NTZWxlY3RvclBhcnNlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcInBvc3Rjc3Mtc2VsZWN0b3ItcGFyc2VyXCIpKTtcbnZhciBfZ2VuZXJhdGVSdWxlcyA9IHJlcXVpcmUoXCIuL2dlbmVyYXRlUnVsZXNcIik7XG52YXIgX2JpZ1NpZ24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi91dGlsL2JpZ1NpZ25cIikpO1xudmFyIF9lc2NhcGVDbGFzc05hbWUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi91dGlsL2VzY2FwZUNsYXNzTmFtZVwiKSk7XG5mdW5jdGlvbiBleHBhbmRBcHBseUF0UnVsZXMoY29udGV4dCkge1xuICAgIHJldHVybiAocm9vdCk9PntcbiAgICAgICAgLy8gQnVpbGQgYSBjYWNoZSBvZiB0aGUgdXNlcidzIENTUyBzbyB3ZSBjYW4gdXNlIGl0IHRvIHJlc29sdmUgY2xhc3NlcyB1c2VkIGJ5IEBhcHBseVxuICAgICAgICBsZXQgbG9jYWxDYWNoZSA9IGxhenlDYWNoZSgoKT0+YnVpbGRMb2NhbEFwcGx5Q2FjaGUocm9vdCwgY29udGV4dCkpO1xuICAgICAgICBwcm9jZXNzQXBwbHkocm9vdCwgY29udGV4dCwgbG9jYWxDYWNoZSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHtcbiAgICAgICAgZGVmYXVsdDogb2JqXG4gICAgfTtcbn1cbi8qKiBAdHlwZWRlZiB7TWFwPHN0cmluZywgW2FueSwgaW1wb3J0KCdwb3N0Y3NzJykuUnVsZVtdXT59IEFwcGx5Q2FjaGUgKi8gZnVuY3Rpb24gZXh0cmFjdENsYXNzZXMobm9kZSkge1xuICAgIC8qKiBAdHlwZSB7TWFwPHN0cmluZywgU2V0PHN0cmluZz4+fSAqLyBsZXQgZ3JvdXBzID0gbmV3IE1hcCgpO1xuICAgIGxldCBjb250YWluZXIgPSBfcG9zdGNzcy5kZWZhdWx0LnJvb3Qoe1xuICAgICAgICBub2RlczogW1xuICAgICAgICAgICAgbm9kZS5jbG9uZSgpXG4gICAgICAgIF1cbiAgICB9KTtcbiAgICBjb250YWluZXIud2Fsa1J1bGVzKChydWxlKT0+e1xuICAgICAgICAoMCwgX3Bvc3Rjc3NTZWxlY3RvclBhcnNlcikuZGVmYXVsdCgoc2VsZWN0b3JzKT0+e1xuICAgICAgICAgICAgc2VsZWN0b3JzLndhbGtDbGFzc2VzKChjbGFzc1NlbGVjdG9yKT0+e1xuICAgICAgICAgICAgICAgIGxldCBwYXJlbnRTZWxlY3RvciA9IGNsYXNzU2VsZWN0b3IucGFyZW50LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgbGV0IGNsYXNzZXMgPSBncm91cHMuZ2V0KHBhcmVudFNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICBpZiAoIWNsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBzLnNldChwYXJlbnRTZWxlY3RvciwgY2xhc3NlcyA9IG5ldyBTZXQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNsYXNzZXMuYWRkKGNsYXNzU2VsZWN0b3IudmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLnByb2Nlc3NTeW5jKHJ1bGUuc2VsZWN0b3IpO1xuICAgIH0pO1xuICAgIGxldCBub3JtYWxpemVkR3JvdXBzID0gQXJyYXkuZnJvbShncm91cHMudmFsdWVzKCksIChjbGFzc2VzKT0+QXJyYXkuZnJvbShjbGFzc2VzKSk7XG4gICAgbGV0IGNsYXNzZXMxID0gbm9ybWFsaXplZEdyb3Vwcy5mbGF0KCk7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oY2xhc3NlczEsIHtcbiAgICAgICAgZ3JvdXBzOiBub3JtYWxpemVkR3JvdXBzXG4gICAgfSk7XG59XG5sZXQgc2VsZWN0b3JFeHRyYWN0b3IgPSAoMCwgX3Bvc3Rjc3NTZWxlY3RvclBhcnNlcikuZGVmYXVsdCgocm9vdCk9PnJvb3Qubm9kZXMubWFwKChub2RlKT0+bm9kZS50b1N0cmluZygpKSk7XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBydWxlU2VsZWN0b3JzXG4gKi8gZnVuY3Rpb24gZXh0cmFjdFNlbGVjdG9ycyhydWxlU2VsZWN0b3JzKSB7XG4gICAgcmV0dXJuIHNlbGVjdG9yRXh0cmFjdG9yLnRyYW5zZm9ybVN5bmMocnVsZVNlbGVjdG9ycyk7XG59XG5mdW5jdGlvbiBleHRyYWN0QmFzZUNhbmRpZGF0ZXMoY2FuZGlkYXRlcywgc2VwYXJhdG9yKSB7XG4gICAgbGV0IGJhc2VDbGFzc2VzID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGNhbmRpZGF0ZSBvZiBjYW5kaWRhdGVzKXtcbiAgICAgICAgYmFzZUNsYXNzZXMuYWRkKGNhbmRpZGF0ZS5zcGxpdChzZXBhcmF0b3IpLnBvcCgpKTtcbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYmFzZUNsYXNzZXMpO1xufVxuZnVuY3Rpb24gcHJlZml4KGNvbnRleHQsIHNlbGVjdG9yKSB7XG4gICAgbGV0IHByZWZpeDEgPSBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnByZWZpeDtcbiAgICByZXR1cm4gdHlwZW9mIHByZWZpeDEgPT09IFwiZnVuY3Rpb25cIiA/IHByZWZpeDEoc2VsZWN0b3IpIDogcHJlZml4MSArIHNlbGVjdG9yO1xufVxuZnVuY3Rpb24qIHBhdGhUb1Jvb3Qobm9kZSkge1xuICAgIHlpZWxkIG5vZGU7XG4gICAgd2hpbGUobm9kZS5wYXJlbnQpe1xuICAgICAgICB5aWVsZCBub2RlLnBhcmVudDtcbiAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50O1xuICAgIH1cbn1cbi8qKlxuICogT25seSBjbG9uZSB0aGUgbm9kZSBpdHNlbGYgYW5kIG5vdCBpdHMgY2hpbGRyZW5cbiAqXG4gKiBAcGFyYW0geyp9IG5vZGVcbiAqIEBwYXJhbSB7Kn0gb3ZlcnJpZGVzXG4gKiBAcmV0dXJuc1xuICovIGZ1bmN0aW9uIHNoYWxsb3dDbG9uZShub2RlLCBvdmVycmlkZXMgPSB7fSkge1xuICAgIGxldCBjaGlsZHJlbiA9IG5vZGUubm9kZXM7XG4gICAgbm9kZS5ub2RlcyA9IFtdO1xuICAgIGxldCB0bXAgPSBub2RlLmNsb25lKG92ZXJyaWRlcyk7XG4gICAgbm9kZS5ub2RlcyA9IGNoaWxkcmVuO1xuICAgIHJldHVybiB0bXA7XG59XG4vKipcbiAqIENsb25lIGp1c3QgdGhlIG5vZGVzIGFsbCB0aGUgd2F5IHRvIHRoZSB0b3AgdGhhdCBhcmUgcmVxdWlyZWQgdG8gcmVwcmVzZW50XG4gKiB0aGlzIHNpbmd1bGFyIHJ1bGUgaW4gdGhlIHRyZWUuXG4gKlxuICogRm9yIGV4YW1wbGUsIGlmIHdlIGhhdmUgQ1NTIGxpa2UgdGhpczpcbiAqIGBgYGNzc1xuICogQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSB7XG4gKiAgIEBzdXBwb3J0cyAoZGlzcGxheTogZ3JpZCkge1xuICogICAgIC5mb28ge1xuICogICAgICAgZGlzcGxheTogZ3JpZDtcbiAqICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMjAwcHgsIDFmcikpO1xuICogICAgIH1cbiAqICAgfVxuICpcbiAqICAgQHN1cHBvcnRzIChiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMXB4KSkge1xuICogICAgIC5iYXIge1xuICogICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDFweCk7XG4gKiAgICAgfVxuICogICB9XG4gKlxuICogICAuYmF6IHtcbiAqICAgICBjb2xvcjogb3JhbmdlO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBBbmQgd2UncmUgY2xvbmluZyBgLmJhcmAgaXQnbGwgcmV0dXJuIGEgY2xvbmVkIHZlcnNpb24gb2Ygd2hhdCdzIHJlcXVpcmVkIGZvciBqdXN0IHRoYXQgc2luZ2xlIG5vZGU6XG4gKlxuICogYGBgY3NzXG4gKiBAbWVkaWEgKG1pbi13aWR0aDogNzY4cHgpIHtcbiAqICAgQHN1cHBvcnRzIChiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMXB4KSkge1xuICogICAgIC5iYXIge1xuICogICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDFweCk7XG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge2ltcG9ydCgncG9zdGNzcycpLk5vZGV9IG5vZGVcbiAqLyBmdW5jdGlvbiBuZXN0ZWRDbG9uZShub2RlKSB7XG4gICAgZm9yIChsZXQgcGFyZW50IG9mIHBhdGhUb1Jvb3Qobm9kZSkpe1xuICAgICAgICBpZiAobm9kZSA9PT0gcGFyZW50KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50LnR5cGUgPT09IFwicm9vdFwiKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBub2RlID0gc2hhbGxvd0Nsb25lKHBhcmVudCwge1xuICAgICAgICAgICAgbm9kZXM6IFtcbiAgICAgICAgICAgICAgICBub2RlXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbn1cbi8qKlxuICogQHBhcmFtIHtpbXBvcnQoJ3Bvc3Rjc3MnKS5Sb290fSByb290XG4gKi8gZnVuY3Rpb24gYnVpbGRMb2NhbEFwcGx5Q2FjaGUocm9vdCwgY29udGV4dCkge1xuICAgIC8qKiBAdHlwZSB7QXBwbHlDYWNoZX0gKi8gbGV0IGNhY2hlID0gbmV3IE1hcCgpO1xuICAgIGxldCBoaWdoZXN0T2Zmc2V0ID0gY29udGV4dC5sYXllck9yZGVyLnVzZXIgPj4gNG47XG4gICAgcm9vdC53YWxrUnVsZXMoKHJ1bGUsIGlkeCk9PntcbiAgICAgICAgLy8gSWdub3JlIHJ1bGVzIGdlbmVyYXRlZCBieSBUYWlsd2luZFxuICAgICAgICBmb3IgKGxldCBub2RlIG9mIHBhdGhUb1Jvb3QocnVsZSkpe1xuICAgICAgICAgICAgdmFyIHJlZjtcbiAgICAgICAgICAgIGlmICgoKHJlZiA9IG5vZGUucmF3cy50YWlsd2luZCkgPT09IG51bGwgfHwgcmVmID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZWYubGF5ZXIpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2xvbmUgd2hhdCdzIHJlcXVpcmVkIHRvIHJlcHJlc2VudCB0aGlzIHNpbmd1bGFyIHJ1bGUgaW4gdGhlIHRyZWVcbiAgICAgICAgbGV0IGNvbnRhaW5lciA9IG5lc3RlZENsb25lKHJ1bGUpO1xuICAgICAgICBmb3IgKGxldCBjbGFzc05hbWUgb2YgZXh0cmFjdENsYXNzZXMocnVsZSkpe1xuICAgICAgICAgICAgbGV0IGxpc3QgPSBjYWNoZS5nZXQoY2xhc3NOYW1lKSB8fCBbXTtcbiAgICAgICAgICAgIGNhY2hlLnNldChjbGFzc05hbWUsIGxpc3QpO1xuICAgICAgICAgICAgbGlzdC5wdXNoKFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgICAgICAgc29ydDogQmlnSW50KGlkeCkgKyBoaWdoZXN0T2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250YWluZXIsIFxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY2FjaGU7XG59XG4vKipcbiAqIEByZXR1cm5zIHtBcHBseUNhY2hlfVxuICovIGZ1bmN0aW9uIGJ1aWxkQXBwbHlDYWNoZShhcHBseUNhbmRpZGF0ZXMsIGNvbnRleHQpIHtcbiAgICBmb3IgKGxldCBjYW5kaWRhdGUgb2YgYXBwbHlDYW5kaWRhdGVzKXtcbiAgICAgICAgaWYgKGNvbnRleHQubm90Q2xhc3NDYWNoZS5oYXMoY2FuZGlkYXRlKSB8fCBjb250ZXh0LmFwcGx5Q2xhc3NDYWNoZS5oYXMoY2FuZGlkYXRlKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRleHQuY2xhc3NDYWNoZS5oYXMoY2FuZGlkYXRlKSkge1xuICAgICAgICAgICAgY29udGV4dC5hcHBseUNsYXNzQ2FjaGUuc2V0KGNhbmRpZGF0ZSwgY29udGV4dC5jbGFzc0NhY2hlLmdldChjYW5kaWRhdGUpLm1hcCgoW21ldGEsIHJ1bGVdKT0+W1xuICAgICAgICAgICAgICAgICAgICBtZXRhLFxuICAgICAgICAgICAgICAgICAgICBydWxlLmNsb25lKClcbiAgICAgICAgICAgICAgICBdKSk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbWF0Y2hlcyA9IEFycmF5LmZyb20oKDAsIF9nZW5lcmF0ZVJ1bGVzKS5yZXNvbHZlTWF0Y2hlcyhjYW5kaWRhdGUsIGNvbnRleHQpKTtcbiAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb250ZXh0Lm5vdENsYXNzQ2FjaGUuYWRkKGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LmFwcGx5Q2xhc3NDYWNoZS5zZXQoY2FuZGlkYXRlLCBtYXRjaGVzKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRleHQuYXBwbHlDbGFzc0NhY2hlO1xufVxuLyoqXG4gKiBCdWlsZCBhIGNhY2hlIG9ubHkgd2hlbiBpdCdzIGZpcnN0IHVzZWRcbiAqXG4gKiBAcGFyYW0geygpID0+IEFwcGx5Q2FjaGV9IGJ1aWxkQ2FjaGVGblxuICogQHJldHVybnMge0FwcGx5Q2FjaGV9XG4gKi8gZnVuY3Rpb24gbGF6eUNhY2hlKGJ1aWxkQ2FjaGVGbikge1xuICAgIGxldCBjYWNoZSA9IG51bGw7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiAobmFtZSk9PntcbiAgICAgICAgICAgIGNhY2hlID0gY2FjaGUgfHwgYnVpbGRDYWNoZUZuKCk7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGUuZ2V0KG5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBoYXM6IChuYW1lKT0+e1xuICAgICAgICAgICAgY2FjaGUgPSBjYWNoZSB8fCBidWlsZENhY2hlRm4oKTtcbiAgICAgICAgICAgIHJldHVybiBjYWNoZS5oYXMobmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuLyoqXG4gKiBUYWtlIGEgc2VyaWVzIG9mIG11bHRpcGxlIGNhY2hlcyBhbmQgbWVyZ2VcbiAqIHRoZW0gc28gdGhleSBhY3QgbGlrZSBvbmUgbGFyZ2UgY2FjaGVcbiAqXG4gKiBAcGFyYW0ge0FwcGx5Q2FjaGVbXX0gY2FjaGVzXG4gKiBAcmV0dXJucyB7QXBwbHlDYWNoZX1cbiAqLyBmdW5jdGlvbiBjb21iaW5lQ2FjaGVzKGNhY2hlcykge1xuICAgIHJldHVybiB7XG4gICAgICAgIGdldDogKG5hbWUpPT5jYWNoZXMuZmxhdE1hcCgoY2FjaGUpPT5jYWNoZS5nZXQobmFtZSkgfHwgW10pLFxuICAgICAgICBoYXM6IChuYW1lKT0+Y2FjaGVzLnNvbWUoKGNhY2hlKT0+Y2FjaGUuaGFzKG5hbWUpKVxuICAgIH07XG59XG5mdW5jdGlvbiBleHRyYWN0QXBwbHlDYW5kaWRhdGVzKHBhcmFtcykge1xuICAgIGxldCBjYW5kaWRhdGVzID0gcGFyYW1zLnNwbGl0KC9bXFxzXFx0XFxuXSsvZyk7XG4gICAgaWYgKGNhbmRpZGF0ZXNbY2FuZGlkYXRlcy5sZW5ndGggLSAxXSA9PT0gXCIhaW1wb3J0YW50XCIpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIGNhbmRpZGF0ZXMuc2xpY2UoMCwgLTEpLFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICBdO1xuICAgIH1cbiAgICByZXR1cm4gW1xuICAgICAgICBjYW5kaWRhdGVzLFxuICAgICAgICBmYWxzZVxuICAgIF07XG59XG5mdW5jdGlvbiBwcm9jZXNzQXBwbHkocm9vdCwgY29udGV4dCwgbG9jYWxDYWNoZSkge1xuICAgIGxldCBhcHBseUNhbmRpZGF0ZXMgPSBuZXcgU2V0KCk7XG4gICAgLy8gQ29sbGVjdCBhbGwgQGFwcGx5IHJ1bGVzIGFuZCBjYW5kaWRhdGVzXG4gICAgbGV0IGFwcGxpZXMgPSBbXTtcbiAgICByb290LndhbGtBdFJ1bGVzKFwiYXBwbHlcIiwgKHJ1bGUpPT57XG4gICAgICAgIGxldCBbY2FuZGlkYXRlc10gPSBleHRyYWN0QXBwbHlDYW5kaWRhdGVzKHJ1bGUucGFyYW1zKTtcbiAgICAgICAgZm9yIChsZXQgdXRpbCBvZiBjYW5kaWRhdGVzKXtcbiAgICAgICAgICAgIGFwcGx5Q2FuZGlkYXRlcy5hZGQodXRpbCk7XG4gICAgICAgIH1cbiAgICAgICAgYXBwbGllcy5wdXNoKHJ1bGUpO1xuICAgIH0pO1xuICAgIC8vIFN0YXJ0IHRoZSBAYXBwbHkgcHJvY2VzcyBpZiB3ZSBoYXZlIHJ1bGVzIHdpdGggQGFwcGx5IGluIHRoZW1cbiAgICBpZiAoYXBwbGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBGaWxsIHVwIHNvbWUgY2FjaGVzIVxuICAgIGxldCBhcHBseUNsYXNzQ2FjaGUgPSBjb21iaW5lQ2FjaGVzKFtcbiAgICAgICAgbG9jYWxDYWNoZSxcbiAgICAgICAgYnVpbGRBcHBseUNhY2hlKGFwcGx5Q2FuZGlkYXRlcywgY29udGV4dClcbiAgICBdKTtcbiAgICAvKipcbiAgICogV2hlbiB3ZSBoYXZlIGFuIGFwcGx5IGxpa2UgdGhpczpcbiAgICpcbiAgICogLmFiYyB7XG4gICAqICAgIEBhcHBseSBob3Zlcjpmb250LWJvbGQ7XG4gICAqIH1cbiAgICpcbiAgICogV2hhdCB3ZSBlc3NlbnRpYWxseSB3aWxsIGRvIGlzIHJlc29sdmUgdG8gdGhpczpcbiAgICpcbiAgICogLmFiYyB7XG4gICAqICAgIEBhcHBseSAuaG92ZXJcXDpmb250LWJvbGQ6aG92ZXIge1xuICAgKiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAqICAgIH1cbiAgICogfVxuICAgKlxuICAgKiBOb3RpY2UgdGhhdCB0aGUgdG8tYmUtYXBwbGllZCBjbGFzcyBpcyBgLmhvdmVyXFw6Zm9udC1ib2xkOmhvdmVyYCBhbmQgdGhhdCB0aGUgdXRpbGl0eSBjYW5kaWRhdGUgd2FzIGBob3Zlcjpmb250LWJvbGRgLlxuICAgKiBXaGF0IGhhcHBlbnMgaW4gdGhpcyBmdW5jdGlvbiBpcyB0aGF0IHdlIHByZXBlbmQgYSBgLmAgYW5kIGVzY2FwZSB0aGUgY2FuZGlkYXRlLlxuICAgKiBUaGlzIHdpbGwgcmVzdWx0IGluIGAuaG92ZXJcXDpmb250LWJvbGRgXG4gICAqIFdoaWNoIG1lYW5zIHRoYXQgd2UgY2FuIHJlcGxhY2UgYC5ob3ZlclxcOmZvbnQtYm9sZGAgd2l0aCBgLmFiY2AgaW4gYC5ob3ZlclxcOmZvbnQtYm9sZDpob3ZlcmAgcmVzdWx0aW5nIGluIGAuYWJjOmhvdmVyYFxuICAgKi8gLy8gVE9ETzogU2hvdWxkIHdlIHVzZSBwb3N0Y3NzLXNlbGVjdG9yLXBhcnNlciBmb3IgdGhpcyBpbnN0ZWFkP1xuICAgIGZ1bmN0aW9uIHJlcGxhY2VTZWxlY3RvcihzZWxlY3RvciwgdXRpbGl0eVNlbGVjdG9ycywgY2FuZGlkYXRlKSB7XG4gICAgICAgIGxldCBuZWVkbGUxID0gYC4keygwLCBfZXNjYXBlQ2xhc3NOYW1lKS5kZWZhdWx0KGNhbmRpZGF0ZSl9YDtcbiAgICAgICAgbGV0IG5lZWRsZXMgPSBbXG4gICAgICAgICAgICAuLi5uZXcgU2V0KFtcbiAgICAgICAgICAgICAgICBuZWVkbGUxLFxuICAgICAgICAgICAgICAgIG5lZWRsZTEucmVwbGFjZSgvXFxcXDJjIC9nLCBcIlxcXFwsXCIpXG4gICAgICAgICAgICBdKVxuICAgICAgICBdO1xuICAgICAgICBsZXQgdXRpbGl0eVNlbGVjdG9yc0xpc3QgPSBleHRyYWN0U2VsZWN0b3JzKHV0aWxpdHlTZWxlY3RvcnMpO1xuICAgICAgICByZXR1cm4gZXh0cmFjdFNlbGVjdG9ycyhzZWxlY3RvcikubWFwKChzKT0+e1xuICAgICAgICAgICAgbGV0IHJlcGxhY2VkID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCB1dGlsaXR5U2VsZWN0b3Igb2YgdXRpbGl0eVNlbGVjdG9yc0xpc3Qpe1xuICAgICAgICAgICAgICAgIGxldCByZXBsYWNlZFNlbGVjdG9yID0gdXRpbGl0eVNlbGVjdG9yO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbmVlZGxlIG9mIG5lZWRsZXMpe1xuICAgICAgICAgICAgICAgICAgICByZXBsYWNlZFNlbGVjdG9yID0gcmVwbGFjZWRTZWxlY3Rvci5yZXBsYWNlKG5lZWRsZSwgcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlZFNlbGVjdG9yID09PSB1dGlsaXR5U2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlcGxhY2VkLnB1c2gocmVwbGFjZWRTZWxlY3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVwbGFjZWQuam9pbihcIiwgXCIpO1xuICAgICAgICB9KS5qb2luKFwiLCBcIik7XG4gICAgfVxuICAgIGxldCBwZXJQYXJlbnRBcHBsaWVzID0gbmV3IE1hcCgpO1xuICAgIC8vIENvbGxlY3QgYWxsIGFwcGx5IGNhbmRpZGF0ZXMgYW5kIHRoZWlyIHJ1bGVzXG4gICAgZm9yIChsZXQgYXBwbHkgb2YgYXBwbGllcyl7XG4gICAgICAgIGxldCBbY2FuZGlkYXRlc10gPSBwZXJQYXJlbnRBcHBsaWVzLmdldChhcHBseS5wYXJlbnQpIHx8IFtcbiAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgYXBwbHkuc291cmNlXG4gICAgICAgIF07XG4gICAgICAgIHBlclBhcmVudEFwcGxpZXMuc2V0KGFwcGx5LnBhcmVudCwgW1xuICAgICAgICAgICAgY2FuZGlkYXRlcyxcbiAgICAgICAgICAgIGFwcGx5LnNvdXJjZVxuICAgICAgICBdKTtcbiAgICAgICAgbGV0IFthcHBseUNhbmRpZGF0ZXMsIGltcG9ydGFudF0gPSBleHRyYWN0QXBwbHlDYW5kaWRhdGVzKGFwcGx5LnBhcmFtcyk7XG4gICAgICAgIGlmIChhcHBseS5wYXJlbnQudHlwZSA9PT0gXCJhdHJ1bGVcIikge1xuICAgICAgICAgICAgaWYgKGFwcGx5LnBhcmVudC5uYW1lID09PSBcInNjcmVlblwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NyZWVuVHlwZSA9IGFwcGx5LnBhcmVudC5wYXJhbXM7XG4gICAgICAgICAgICAgICAgdGhyb3cgYXBwbHkuZXJyb3IoYEBhcHBseSBpcyBub3Qgc3VwcG9ydGVkIHdpdGhpbiBuZXN0ZWQgYXQtcnVsZXMgbGlrZSBAc2NyZWVuLiBXZSBzdWdnZXN0IHlvdSB3cml0ZSB0aGlzIGFzIEBhcHBseSAke2FwcGx5Q2FuZGlkYXRlcy5tYXAoKGMpPT5gJHtzY3JlZW5UeXBlfToke2N9YCkuam9pbihcIiBcIil9IGluc3RlYWQuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgQGFwcGx5IGlzIG5vdCBzdXBwb3J0ZWQgd2l0aGluIG5lc3RlZCBhdC1ydWxlcyBsaWtlIEAke2FwcGx5LnBhcmVudC5uYW1lfS4gWW91IGNhbiBmaXggdGhpcyBieSB1bi1uZXN0aW5nIEAke2FwcGx5LnBhcmVudC5uYW1lfS5gKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBhcHBseUNhbmRpZGF0ZSBvZiBhcHBseUNhbmRpZGF0ZXMpe1xuICAgICAgICAgICAgaWYgKFtcbiAgICAgICAgICAgICAgICBwcmVmaXgoY29udGV4dCwgXCJncm91cFwiKSxcbiAgICAgICAgICAgICAgICBwcmVmaXgoY29udGV4dCwgXCJwZWVyXCIpXG4gICAgICAgICAgICBdLmluY2x1ZGVzKGFwcGx5Q2FuZGlkYXRlKSkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IExpbmsgdG8gc3BlY2lmaWMgZG9jdW1lbnRhdGlvbiBwYWdlIHdpdGggZXJyb3IgY29kZS5cbiAgICAgICAgICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgQGFwcGx5IHNob3VsZCBub3QgYmUgdXNlZCB3aXRoIHRoZSAnJHthcHBseUNhbmRpZGF0ZX0nIHV0aWxpdHlgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghYXBwbHlDbGFzc0NhY2hlLmhhcyhhcHBseUNhbmRpZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgVGhlIFxcYCR7YXBwbHlDYW5kaWRhdGV9XFxgIGNsYXNzIGRvZXMgbm90IGV4aXN0LiBJZiBcXGAke2FwcGx5Q2FuZGlkYXRlfVxcYCBpcyBhIGN1c3RvbSBjbGFzcywgbWFrZSBzdXJlIGl0IGlzIGRlZmluZWQgd2l0aGluIGEgXFxgQGxheWVyXFxgIGRpcmVjdGl2ZS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBydWxlcyA9IGFwcGx5Q2xhc3NDYWNoZS5nZXQoYXBwbHlDYW5kaWRhdGUpO1xuICAgICAgICAgICAgY2FuZGlkYXRlcy5wdXNoKFtcbiAgICAgICAgICAgICAgICBhcHBseUNhbmRpZGF0ZSxcbiAgICAgICAgICAgICAgICBpbXBvcnRhbnQsXG4gICAgICAgICAgICAgICAgcnVsZXNcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgW3BhcmVudCwgW2NhbmRpZGF0ZXMxLCBhdEFwcGx5U291cmNlXV0gb2YgcGVyUGFyZW50QXBwbGllcyl7XG4gICAgICAgIGxldCBzaWJsaW5ncyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBbYXBwbHlDYW5kaWRhdGUsIGltcG9ydGFudCwgcnVsZXNdIG9mIGNhbmRpZGF0ZXMxKXtcbiAgICAgICAgICAgIGxldCBwb3RlbnRpYWxBcHBseUNhbmRpZGF0ZXMgPSBbXG4gICAgICAgICAgICAgICAgYXBwbHlDYW5kaWRhdGUsXG4gICAgICAgICAgICAgICAgLi4uZXh0cmFjdEJhc2VDYW5kaWRhdGVzKFtcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlDYW5kaWRhdGVcbiAgICAgICAgICAgICAgICBdLCBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnNlcGFyYXRvciksIFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGZvciAobGV0IFttZXRhLCBub2RlMV0gb2YgcnVsZXMpe1xuICAgICAgICAgICAgICAgIGxldCBwYXJlbnRDbGFzc2VzID0gZXh0cmFjdENsYXNzZXMocGFyZW50KTtcbiAgICAgICAgICAgICAgICBsZXQgbm9kZUNsYXNzZXMgPSBleHRyYWN0Q2xhc3Nlcyhub2RlMSk7XG4gICAgICAgICAgICAgICAgLy8gV2hlbiB3ZSBlbmNvdW50ZXIgYSBydWxlIGxpa2UgYC5kYXJrIC5hLCAuYiB7IOKApiB9YCB3ZSBvbmx5IHdhbnQgdG8gYmUgbGVmdCB3aXRoIGBbLmRhcmssIC5hXWAgaWYgdGhlIGJhc2UgYXBwbHlDYW5kaWRhdGUgaXMgYC5hYCBvciB3aXRoIGBbLmJdYCBpZiB0aGUgYmFzZSBhcHBseUNhbmRpZGF0ZSBpcyBgLmJgXG4gICAgICAgICAgICAgICAgLy8gU28gd2UndmUgc3BsaXQgdGhlbSBpbnRvIGdyb3Vwc1xuICAgICAgICAgICAgICAgIG5vZGVDbGFzc2VzID0gbm9kZUNsYXNzZXMuZ3JvdXBzLmZpbHRlcigoY2xhc3NMaXN0KT0+Y2xhc3NMaXN0LnNvbWUoKGNsYXNzTmFtZSk9PnBvdGVudGlhbEFwcGx5Q2FuZGlkYXRlcy5pbmNsdWRlcyhjbGFzc05hbWUpKSkuZmxhdCgpO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBiYXNlIHV0aWxpdHkgY2xhc3NlcyBmcm9tIHRoZSBAYXBwbHkgbm9kZSB0byB0aGUgbGlzdCBvZlxuICAgICAgICAgICAgICAgIC8vIGNsYXNzZXMgdG8gY2hlY2sgd2hldGhlciBpdCBpbnRlcnNlY3RzIGFuZCB0aGVyZWZvcmUgcmVzdWx0cyBpbiBhXG4gICAgICAgICAgICAgICAgLy8gY2lyY3VsYXIgZGVwZW5kZW5jeSBvciBub3QuXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBFLmcuOlxuICAgICAgICAgICAgICAgIC8vIC5mb28ge1xuICAgICAgICAgICAgICAgIC8vICAgQGFwcGx5IGhvdmVyOmE7IC8vIFRoaXMgYXBwbGllcyBcImFcIiBidXQgd2l0aCBhIG1vZGlmaWVyXG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSBoYXZlIHRvIGRvIHRoYXQgd2l0aCBiYXNlIGNsYXNzZXMgb2YgdGhlIGBub2RlYCwgbm90IG9mIHRoZSBgcGFyZW50YFxuICAgICAgICAgICAgICAgIC8vIEUuZy46XG4gICAgICAgICAgICAgICAgLy8gLmhvdmVyXFw6Zm9vIHtcbiAgICAgICAgICAgICAgICAvLyAgIEBhcHBseSBiYXI7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIC5iYXIge1xuICAgICAgICAgICAgICAgIC8vICAgQGFwcGx5IGZvbztcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBub3QgcmVzdWx0IGluIGEgY2lyY3VsYXIgZGVwZW5kZW5jeSBiZWNhdXNlIHdlIGFyZVxuICAgICAgICAgICAgICAgIC8vIGp1c3QgYXBwbHlpbmcgYC5mb29gIGFuZCB0aGUgcnVsZSBhYm92ZSBpcyBgLmhvdmVyXFw6Zm9vYCB3aGljaCBpc1xuICAgICAgICAgICAgICAgIC8vIHVucmVsYXRlZC4gSG93ZXZlciwgaWYgd2Ugd2VyZSB0byBhcHBseSBgaG92ZXI6Zm9vYCB0aGVuIHdlIF9kaWRfXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSB0byBpbmNsdWRlIHRoaXMgb25lLlxuICAgICAgICAgICAgICAgIG5vZGVDbGFzc2VzID0gbm9kZUNsYXNzZXMuY29uY2F0KGV4dHJhY3RCYXNlQ2FuZGlkYXRlcyhub2RlQ2xhc3NlcywgY29udGV4dC50YWlsd2luZENvbmZpZy5zZXBhcmF0b3IpKTtcbiAgICAgICAgICAgICAgICBsZXQgaW50ZXJzZWN0cyA9IHBhcmVudENsYXNzZXMuc29tZSgoc2VsZWN0b3IpPT5ub2RlQ2xhc3Nlcy5pbmNsdWRlcyhzZWxlY3RvcikpO1xuICAgICAgICAgICAgICAgIGlmIChpbnRlcnNlY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5vZGUxLmVycm9yKGBZb3UgY2Fubm90IFxcYEBhcHBseVxcYCB0aGUgXFxgJHthcHBseUNhbmRpZGF0ZX1cXGAgdXRpbGl0eSBoZXJlIGJlY2F1c2UgaXQgY3JlYXRlcyBhIGNpcmN1bGFyIGRlcGVuZGVuY3kuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCByb290ID0gX3Bvc3Rjc3MuZGVmYXVsdC5yb290KHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUxLmNsb25lKClcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBldmVyeSBub2RlIGluIHRoZSBlbnRpcmUgdHJlZSBwb2ludHMgYmFjayBhdCB0aGUgQGFwcGx5IHJ1bGUgdGhhdCBnZW5lcmF0ZWQgaXRcbiAgICAgICAgICAgICAgICByb290LndhbGsoKG5vZGUpPT57XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuc291cmNlID0gYXRBcHBseVNvdXJjZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBsZXQgY2FuUmV3cml0ZVNlbGVjdG9yID0gbm9kZTEudHlwZSAhPT0gXCJhdHJ1bGVcIiB8fCBub2RlMS50eXBlID09PSBcImF0cnVsZVwiICYmIG5vZGUxLm5hbWUgIT09IFwia2V5ZnJhbWVzXCI7XG4gICAgICAgICAgICAgICAgaWYgKGNhblJld3JpdGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICByb290LndhbGtSdWxlcygocnVsZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExldCdzIGltYWdpbmUgeW91IGhhdmUgdGhlIGZvbGxvd2luZyBzdHJ1Y3R1cmU6XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmZvbyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIEBhcHBseSBiYXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHN1cHBvcnRzIChhOiBiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIC5iYXIge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGNvbG9yOiBibHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIC5zb21ldGhpbmctdW5yZWxhdGVkIHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gdGhpcyBjYXNlIHdlIHdhbnQgdG8gYXBwbHkgYC5iYXJgIGJ1dCBpdCBoYXBwZW5zIHRvIGJlIGluXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbiBhdHJ1bGUgbm9kZS4gV2UgY2xvbmUgdGhhdCBub2RlIGluc3RlYWQgb2YgdGhlIG5lc3RlZCBvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJlY2F1c2Ugd2Ugc3RpbGwgd2FudCB0aGF0IEBzdXBwb3J0cyBydWxlIHRvIGJlIHRoZXJlIG9uY2Ugd2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcGxpZWQgZXZlcnl0aGluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIb3dldmVyIGl0IGhhcHBlbnMgdG8gYmUgdGhhdCB0aGUgYC5zb21ldGhpbmctdW5yZWxhdGVkYCBpc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxzbyBpbiB0aGF0IHNhbWUgc2hhcmVkIEBzdXBwb3J0cyBhdHJ1bGUuIFRoaXMgaXMgbm90IGdvb2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgdGhpcyBzaG91bGQgbm90IGJlIHRoZXJlLiBUaGUgZ29vZCBwYXJ0IGlzIHRoYXQgdGhpcyBpc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBjbG9uZSBhbHJlYWR5IGFuZCBpdCBjYW4gYmUgc2FmZWx5IHJlbW92ZWQuIFRoZSBxdWVzdGlvbiBpc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaG93IGRvIHdlIGtub3cgd2UgY2FuIHJlbW92ZSBpdC4gQmFzaWNhbGx5IHdoYXQgd2UgY2FuIGRvIGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXRjaCBpdCBhZ2FpbnN0IHRoZSBhcHBseUNhbmRpZGF0ZSB0aGF0IHlvdSB3YW50IHRvIGFwcGx5LiBJZlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQgZG9lc24ndCBtYXRjaCB0aGUgd2UgY2FuIHNhZmVseSBkZWxldGUgaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGRvIHRoaXMsIHRoZW4gdGhlIGByZXBsYWNlU2VsZWN0b3JgIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3VsZCBoYXZlIHJlcGxhY2VkIHRoaXMgd2l0aCBzb21ldGhpbmcgdGhhdCBkaWRuJ3QgZXhpc3QgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZWZvcmUgaXQgcmVtb3ZlZCB0aGUgc2VsZWN0b3IgYWx0b2dldGhlci4gSW4gdGhpcyBzcGVjaWZpY1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSBpdCB3b3VsZCByZXN1bHQgaW4gYHt9YCBpbnN0ZWFkIG9mIGAuc29tZXRoaW5nLXVucmVsYXRlZCB7fWBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXh0cmFjdENsYXNzZXMocnVsZSkuc29tZSgoY2FuZGlkYXRlKT0+Y2FuZGlkYXRlID09PSBhcHBseUNhbmRpZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0cmlwIHRoZSBpbXBvcnRhbnQgc2VsZWN0b3IgZnJvbSB0aGUgcGFyZW50IHNlbGVjdG9yIGlmIGF0IHRoZSBiZWdpbm5pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbXBvcnRhbnRTZWxlY3RvciA9IHR5cGVvZiBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLmltcG9ydGFudCA9PT0gXCJzdHJpbmdcIiA/IGNvbnRleHQudGFpbHdpbmRDb25maWcuaW1wb3J0YW50IDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG9ubHkgd2FudCB0byBtb3ZlIHRoZSBcImltcG9ydGFudFwiIHNlbGVjdG9yIGlmIHRoaXMgaXMgYSBUYWlsd2luZC1nZW5lcmF0ZWQgdXRpbGl0eVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgZG8gKm5vdCogd2FudCB0byBkbyB0aGlzIGZvciB1c2VyIENTUyB0aGF0IGhhcHBlbnMgdG8gYmUgc3RydWN0dXJlZCB0aGUgc2FtZVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlzR2VuZXJhdGVkID0gcGFyZW50LnJhd3MudGFpbHdpbmQgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnRTZWxlY3RvciA9IGlzR2VuZXJhdGVkICYmIGltcG9ydGFudFNlbGVjdG9yICYmIHBhcmVudC5zZWxlY3Rvci5pbmRleE9mKGltcG9ydGFudFNlbGVjdG9yKSA9PT0gMCA/IHBhcmVudC5zZWxlY3Rvci5zbGljZShpbXBvcnRhbnRTZWxlY3Rvci5sZW5ndGgpIDogcGFyZW50LnNlbGVjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5zZWxlY3RvciA9IHJlcGxhY2VTZWxlY3RvcihwYXJlbnRTZWxlY3RvciwgcnVsZS5zZWxlY3RvciwgYXBwbHlDYW5kaWRhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW5kIHRoZW4gcmUtYWRkIGl0IGlmIGl0IHdhcyByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1wb3J0YW50U2VsZWN0b3IgJiYgcGFyZW50U2VsZWN0b3IgIT09IHBhcmVudC5zZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuc2VsZWN0b3IgPSBgJHtpbXBvcnRhbnRTZWxlY3Rvcn0gJHtydWxlLnNlbGVjdG9yfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLndhbGtEZWNscygoZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmltcG9ydGFudCA9IG1ldGEuaW1wb3J0YW50IHx8IGltcG9ydGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGl0XG4gICAgICAgICAgICAgICAgc2libGluZ3MucHVzaChbXG4gICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB0aGF0IHdoZW4gd2UgYXJlIHNvcnRpbmcsIHRoYXQgd2UgdGFrZSB0aGUgbGF5ZXIgb3JkZXIgaW50byBhY2NvdW50XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLm1ldGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0OiBtZXRhLnNvcnQgfCBjb250ZXh0LmxheWVyT3JkZXJbbWV0YS5sYXllcl1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcm9vdC5ub2Rlc1swXSwgXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSW5qZWN0IHRoZSBydWxlcywgc29ydGVkLCBjb3JyZWN0bHlcbiAgICAgICAgbGV0IG5vZGVzID0gc2libGluZ3Muc29ydCgoW2FdLCBbel0pPT4oMCwgX2JpZ1NpZ24pLmRlZmF1bHQoYS5zb3J0IC0gei5zb3J0KSkubWFwKChzKT0+c1sxXSk7XG4gICAgICAgIC8vIGBwYXJlbnRgIHJlZmVycyB0byB0aGUgbm9kZSBhdCBgLmFiY2AgaW46IC5hYmMgeyBAYXBwbHkgbXQtMiB9XG4gICAgICAgIHBhcmVudC5hZnRlcihub2Rlcyk7XG4gICAgfVxuICAgIGZvciAobGV0IGFwcGx5MSBvZiBhcHBsaWVzKXtcbiAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGxlZnQtb3ZlciBkZWNsYXJhdGlvbnMsIGp1c3QgcmVtb3ZlIHRoZSBAYXBwbHlcbiAgICAgICAgaWYgKGFwcGx5MS5wYXJlbnQubm9kZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgYXBwbHkxLnJlbW92ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVGhlIG5vZGUgaXMgZW1wdHksIGRyb3AgdGhlIGZ1bGwgbm9kZVxuICAgICAgICAgICAgYXBwbHkxLnBhcmVudC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBEbyBpdCBhZ2FpbiwgaW4gY2FzZSB3ZSBoYXZlIG90aGVyIGBAYXBwbHlgIHJ1bGVzXG4gICAgcHJvY2Vzc0FwcGx5KHJvb3QsIGNvbnRleHQsIGxvY2FsQ2FjaGUpO1xufVxuIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY29udGV4dCIsInJvb3QiLCJsb2NhbENhY2hlIiwiYnVpbGRDYWNoZUZuIiwiY2FjaGUiLCJnZXQiLCJuYW1lIiwiaGFzIiwibGF6eUNhY2hlIiwiTWFwIiwiaGlnaGVzdE9mZnNldCIsImxheWVyT3JkZXIiLCJ1c2VyIiwid2Fsa1J1bGVzIiwicnVsZSIsImlkeCIsIm5vZGUiLCJwYXRoVG9Sb290IiwicmVmIiwidW5kZWZpbmVkIiwicmF3cyIsInRhaWx3aW5kIiwibGF5ZXIiLCJjb250YWluZXIiLCJwYXJlbnQiLCJ0eXBlIiwic2hhbGxvd0Nsb25lIiwibm9kZXMiLCJuZXN0ZWRDbG9uZSIsImNsYXNzTmFtZSIsImV4dHJhY3RDbGFzc2VzIiwibGlzdCIsInNldCIsInB1c2giLCJzb3J0IiwiQmlnSW50IiwiaW1wb3J0YW50IiwiYnVpbGRMb2NhbEFwcGx5Q2FjaGUiLCJwcm9jZXNzQXBwbHkiLCJfcG9zdGNzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfcG9zdGNzc1NlbGVjdG9yUGFyc2VyIiwiX2dlbmVyYXRlUnVsZXMiLCJfYmlnU2lnbiIsIl9lc2NhcGVDbGFzc05hbWUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdyb3VwcyIsImNsb25lIiwic2VsZWN0b3JzIiwid2Fsa0NsYXNzZXMiLCJjbGFzc1NlbGVjdG9yIiwicGFyZW50U2VsZWN0b3IiLCJ0b1N0cmluZyIsImNsYXNzZXMiLCJTZXQiLCJhZGQiLCJwcm9jZXNzU3luYyIsInNlbGVjdG9yIiwibm9ybWFsaXplZEdyb3VwcyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImNsYXNzZXMxIiwiZmxhdCIsImFzc2lnbiIsInNlbGVjdG9yRXh0cmFjdG9yIiwibWFwIiwiZXh0cmFjdFNlbGVjdG9ycyIsInJ1bGVTZWxlY3RvcnMiLCJ0cmFuc2Zvcm1TeW5jIiwiZXh0cmFjdEJhc2VDYW5kaWRhdGVzIiwiY2FuZGlkYXRlcyIsInNlcGFyYXRvciIsImJhc2VDbGFzc2VzIiwiY2FuZGlkYXRlIiwic3BsaXQiLCJwb3AiLCJwcmVmaXgiLCJwcmVmaXgxIiwidGFpbHdpbmRDb25maWciLCJvdmVycmlkZXMiLCJjaGlsZHJlbiIsInRtcCIsImJ1aWxkQXBwbHlDYWNoZSIsImFwcGx5Q2FuZGlkYXRlcyIsIm5vdENsYXNzQ2FjaGUiLCJhcHBseUNsYXNzQ2FjaGUiLCJjbGFzc0NhY2hlIiwibWV0YSIsIm1hdGNoZXMiLCJyZXNvbHZlTWF0Y2hlcyIsImxlbmd0aCIsImV4dHJhY3RBcHBseUNhbmRpZGF0ZXMiLCJwYXJhbXMiLCJzbGljZSIsImFwcGxpZXMiLCJ3YWxrQXRSdWxlcyIsInV0aWwiLCJjYWNoZXMiLCJmbGF0TWFwIiwic29tZSIsInJlcGxhY2VTZWxlY3RvciIsInV0aWxpdHlTZWxlY3RvcnMiLCJuZWVkbGUxIiwibmVlZGxlcyIsInJlcGxhY2UiLCJ1dGlsaXR5U2VsZWN0b3JzTGlzdCIsInMiLCJyZXBsYWNlZCIsInV0aWxpdHlTZWxlY3RvciIsInJlcGxhY2VkU2VsZWN0b3IiLCJuZWVkbGUiLCJqb2luIiwicGVyUGFyZW50QXBwbGllcyIsImFwcGx5Iiwic291cmNlIiwic2NyZWVuVHlwZSIsImVycm9yIiwiYyIsImFwcGx5Q2FuZGlkYXRlIiwiaW5jbHVkZXMiLCJydWxlcyIsImNhbmRpZGF0ZXMxIiwiYXRBcHBseVNvdXJjZSIsInNpYmxpbmdzIiwicG90ZW50aWFsQXBwbHlDYW5kaWRhdGVzIiwibm9kZTEiLCJwYXJlbnRDbGFzc2VzIiwibm9kZUNsYXNzZXMiLCJmaWx0ZXIiLCJjbGFzc0xpc3QiLCJjb25jYXQiLCJ3YWxrIiwicmVtb3ZlIiwiaW1wb3J0YW50U2VsZWN0b3IiLCJpbmRleE9mIiwid2Fsa0RlY2xzIiwiZCIsImEiLCJ6IiwiYWZ0ZXIiLCJhcHBseTEiXSwic291cmNlUm9vdCI6IiJ9