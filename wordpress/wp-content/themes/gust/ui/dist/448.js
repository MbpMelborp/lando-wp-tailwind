"use strict";(self.webpackChunkgust_builder=self.webpackChunkgust_builder||[]).push([[448,146],{90448:(e,t,l)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return t=>{!function(e){let t=new Set;e.walkAtRules("apply",(e=>{t.add(e.parent)}));for(let e of t){let t=[],l=[];for(let n of e.nodes)"atrule"===n.type&&"apply"===n.name?(l.length>0&&(t.push(l),l=[]),t.push([n])):l.push(n);if(l.length>0&&t.push(l),1!==t.length){for(let l of[...t].reverse()){let t=e.clone({nodes:[]});t.append(l),e.after(t)}e.remove()}}}(t),f(t,e)}};var n=a(l(50020)),r=l(47146),o=a(l(2500)),s=a(l(10882));function a(e){return e&&e.__esModule?e:{default:e}}function i(e){let t=e.split(/[\s\t\n]+/g);return"!important"===t[t.length-1]?[t.slice(0,-1),!0]:[t,!1]}function f(e,t){let l=new Set,a=[];if(e.walkAtRules("apply",(e=>{let[t]=i(e.params);for(let e of t)l.add(e);a.push(e)})),a.length>0){let u=function(e,t){for(let l of e){if(t.notClassCache.has(l)||t.applyClassCache.has(l))continue;if(t.classCache.has(l)){t.applyClassCache.set(l,t.classCache.get(l).map((([e,t])=>[e,t.clone()])));continue}let e=Array.from((0,r.resolveMatches)(l,t));0!==e.length?t.applyClassCache.set(l,e):t.notClassCache.add(l)}return t.applyClassCache}(l,t);function p(e,t,l){let n=`.${(0,s.default)(l)}`,r=t.split(/\s*,\s*/g);return e.split(/\s*,\s*/g).map((e=>{let t=[];for(let l of r){let r=l.replace(n,e);r!==l&&t.push(r)}return t.join(", ")})).join(", ")}let c=new Map;for(let e of a){let t=c.get(e.parent)||[];c.set(e.parent,t);let[l,n]=i(e.params);if("atrule"===e.parent.type){if("screen"===e.parent.name){const t=e.parent.params;throw e.error(`@apply is not supported within nested at-rules like @screen. We suggest you write this as @apply ${l.map((e=>`${t}:${e}`)).join(" ")} instead.`)}throw e.error(`@apply is not supported within nested at-rules like @${e.parent.name}. You can fix this by un-nesting @${e.parent.name}.`)}for(let r of l){if(!u.has(r))throw e.error(`The \`${r}\` class does not exist. If \`${r}\` is a custom class, make sure it is defined within a \`@layer\` directive.`);let l=u.get(r);t.push([r,n,l])}}for(const[e,t]of c){let l=[];for(let[r,o,s]of t)for(let[t,a]of s){let s=n.default.root({nodes:[a.clone()]});("atrule"!==a.type||"atrule"===a.type&&"keyframes"!==a.name)&&s.walkRules((l=>{l.selector=p(e.selector,l.selector,r),l.walkDecls((e=>{e.important=t.important||o}))})),l.push([t,s.nodes[0]])}let r=l.sort((([e],[t])=>(0,o.default)(e.sort-t.sort))).map((e=>e[1]));e.after(r)}for(let e of a)e.parent.nodes.length>1?e.remove():e.parent.remove();f(e,t)}}},47146:(e,t,l)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveMatches=C,t.generateRules=function(e,t){let l=[];for(let n of e){if(t.notClassCache.has(n))continue;if(t.classCache.has(n)){l.push(t.classCache.get(n));continue}let e=Array.from(C(n,t));0!==e.length?(t.classCache.set(n,e),l.push(e)):t.notClassCache.add(n)}return l.flat(1).map((([{sort:e,layer:l,options:r},o])=>{if(r.respectImportant)if(!0===t.tailwindConfig.important)o.walkDecls((e=>{"rule"!==e.parent.type||w(e.parent)||(e.important=!0)}));else if("string"==typeof t.tailwindConfig.important){let e=n.default.root({nodes:[o.clone()]});e.walkRules((e=>{w(e)||(e.selectors=e.selectors.map((e=>`${t.tailwindConfig.important} ${e}`)))})),o=e.nodes[0]}return[e|t.layerOrder[l],o]}))};var n=f(l(50020)),r=f(l(97161)),o=f(l(20772)),s=f(l(40293)),a=f(l(41812)),i=l(78511);function f(e){return e&&e.__esModule?e:{default:e}}let u=(0,r.default)((e=>e.first.filter((({type:e})=>"class"===e)).pop().value));function p(e){return u.transformSync(e)}function*c(e,t=1/0){if(t<0)return;let l;if(t===1/0&&e.endsWith("]")){let t=e.indexOf("[");l=["-","/"].includes(e[t-1])?t-1:-1}else l=e.lastIndexOf("-",t);if(l<0)return;let n=e.slice(0,l),r=e.slice(l+1);yield[n,r],yield*c(e,l-1)}function d(e,t){if(0===e.length||""===t.tailwindConfig.prefix)return e;for(let l of e){let[e]=l;if(e.options.respectPrefix){let e=n.default.root({nodes:[l[1].clone()]});e.walkRules((e=>{e.selector=(0,a.default)(t.tailwindConfig.prefix,e.selector)})),l[1]=e.nodes[0]}}return e}function h(e){if(0===e.length)return e;let t=[];for(let[l,r]of e){let e=n.default.root({nodes:[r.clone()]});e.walkRules((e=>{e.selector=(0,i.updateAllClasses)(e.selector,(e=>`!${e}`)),e.walkDecls((e=>e.important=!0))})),t.push([{...l,important:!0},e.nodes[0]])}return t}function y(e,t,l){if(0===t.length)return t;if(l.variantMap.has(e)){let r=l.variantMap.get(e),o=[];for(let[e,s]of t){if(!1===e.options.respectVariants){o.push([e,s]);continue}let t=n.default.root({nodes:[s.clone()]});for(let[n,s]of r){let r=t.clone();function a(e){return r.each((t=>{"rule"===t.type&&(t.selectors=t.selectors.map((t=>e({get className(){return p(t)},selector:t}))))})),r}if(null===s({container:r,separator:l.tailwindConfig.separator,modifySelectors:a}))continue;let i=[{...e,sort:n|e.sort},r.nodes[0]];o.push(i)}}return o}return[]}function g(e,t,l={}){return(0,s.default)(e)||Array.isArray(e)?Array.isArray(e)?g(e[0],t,e[1]):(t.has(e)||t.set(e,(0,o.default)(e)),[t.get(e),l]):[[e],l]}function*m(e,t){t.candidateRuleMap.has(e)&&(yield[t.candidateRuleMap.get(e),"DEFAULT"]);let l=e,n=!1;const r=t.tailwindConfig.prefix||"",o=r.length;"-"===l[o]&&(n=!0,l=r+l.slice(o+1));for(let[e,r]of c(l))if(t.candidateRuleMap.has(e))return void(yield[t.candidateRuleMap.get(e),n?`-${r}`:r])}function*C(e,t){let l=t.tailwindConfig.separator,[n,...r]=function(e,t){return e.split(new RegExp(`\\${t}(?![^[]*\\])`,"g"))}(e,l).reverse(),o=!1;n.startsWith("!")&&(o=!0,n=n.slice(1));for(let e of m(n,t)){let l=[],[n,s]=e;for(let[e,r]of n)if("function"==typeof r)for(let n of[].concat(r(s))){let[r,o]=g(n,t.postCssNodeCache);for(let t of r)l.push([{...e,options:{...e.options,...o}},t])}else if("DEFAULT"===s){let n=r,[o,s]=g(n,t.postCssNodeCache);for(let t of o)l.push([{...e,options:{...e.options,...s}},t])}l=d(l,t),o&&(l=h(l));for(let e of r)l=y(e,l,t);for(let e of l)yield e}}function w(e){return e.parent&&"atrule"===e.parent.type&&"keyframes"===e.parent.name}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FBV3BILFVBQ3pFb0QsR0FBWSxFQUVac0UsRUFBZVUsV0FBVyxPQUM1QmhGLEdBQVksRUFDWnNFLEVBQWlCQSxFQUFldEcsTUFBTSxJQWN4QyxJQUFLLElBQUlpSCxLQUFrQlosRUFBc0JDLEVBQWdCM0ksR0FBVSxDQUN6RSxJQUFJa0QsRUFBVSxJQUNUcUcsRUFBU3BDLEdBQVltQyxFQUUxQixJQUFLLElBQUt2RSxFQUFNeUUsS0FBV0QsRUFDekIsR0FBc0IsbUJBQVhDLEVBQ1QsSUFBSyxJQUFJQyxJQUFXLEdBQUdDLE9BQU9GLEVBQU9yQyxJQUFZLENBQy9DLElBQUt6QyxFQUFPWSxHQUFXaUQsRUFBV2tCLEVBQVN6SixFQUFRMkosa0JBRW5ELElBQUssSUFBSXRKLEtBQVFxRSxFQUNmeEIsRUFBUW5DLEtBQUssQ0FBQyxJQUFLZ0UsRUFDakJPLFFBQVMsSUFBS1AsRUFBS08sV0FDZEEsSUFFSmpGLFNBSUosR0FBaUIsWUFBYjhHLEVBQXdCLENBQy9CLElBQUlzQyxFQUFVRCxHQUNUOUUsRUFBT1ksR0FBV2lELEVBQVdrQixFQUFTekosRUFBUTJKLGtCQUVuRCxJQUFLLElBQUl0SixLQUFRcUUsRUFDZnhCLEVBQVFuQyxLQUFLLENBQUMsSUFBS2dFLEVBQ2pCTyxRQUFTLElBQUtQLEVBQUtPLFdBQ2RBLElBRUpqRixJQUtUNkMsRUFBVWtFLEVBQVlsRSxFQUFTbEQsR0FFM0JxRSxJQUNGbkIsRUFBVXFFLEVBQWVyRSxJQUczQixJQUFLLElBQUkwRSxLQUFXcUIsRUFDbEIvRixFQUFVeUUsRUFBYUMsRUFBUzFFLEVBQVNsRCxHQUczQyxJQUFLLElBQUlxSCxLQUFTbkUsUUFDVm1FLEdBS1osU0FBUzVCLEVBQVlwRixHQUNuQixPQUFPQSxFQUFLRSxRQUErQixXQUFyQkYsRUFBS0UsT0FBT0ssTUFBMEMsY0FBckJQLEVBQUtFLE9BQU9NIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ3VzdC1idWlsZGVyLy4vbm9kZV9tb2R1bGVzL3RhaWx3aW5kY3NzL2xpYi9qaXQvbGliL2V4cGFuZEFwcGx5QXRSdWxlcy5qcyIsIndlYnBhY2s6Ly9ndXN0LWJ1aWxkZXIvLi9ub2RlX21vZHVsZXMvdGFpbHdpbmRjc3MvbGliL2ppdC9saWIvZ2VuZXJhdGVSdWxlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cGFuZEFwcGx5QXRSdWxlcztcblxudmFyIF9wb3N0Y3NzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwicG9zdGNzc1wiKSk7XG5cbnZhciBfZ2VuZXJhdGVSdWxlcyA9IHJlcXVpcmUoXCIuL2dlbmVyYXRlUnVsZXNcIik7XG5cbnZhciBfYmlnU2lnbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL3V0aWwvYmlnU2lnblwiKSk7XG5cbnZhciBfZXNjYXBlQ2xhc3NOYW1lID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vdXRpbC9lc2NhcGVDbGFzc05hbWVcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBidWlsZEFwcGx5Q2FjaGUoYXBwbHlDYW5kaWRhdGVzLCBjb250ZXh0KSB7XG4gIGZvciAobGV0IGNhbmRpZGF0ZSBvZiBhcHBseUNhbmRpZGF0ZXMpIHtcbiAgICBpZiAoY29udGV4dC5ub3RDbGFzc0NhY2hlLmhhcyhjYW5kaWRhdGUpIHx8IGNvbnRleHQuYXBwbHlDbGFzc0NhY2hlLmhhcyhjYW5kaWRhdGUpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5jbGFzc0NhY2hlLmhhcyhjYW5kaWRhdGUpKSB7XG4gICAgICBjb250ZXh0LmFwcGx5Q2xhc3NDYWNoZS5zZXQoY2FuZGlkYXRlLCBjb250ZXh0LmNsYXNzQ2FjaGUuZ2V0KGNhbmRpZGF0ZSkubWFwKChbbWV0YSwgcnVsZV0pID0+IFttZXRhLCBydWxlLmNsb25lKCldKSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBsZXQgbWF0Y2hlcyA9IEFycmF5LmZyb20oKDAsIF9nZW5lcmF0ZVJ1bGVzLnJlc29sdmVNYXRjaGVzKShjYW5kaWRhdGUsIGNvbnRleHQpKTtcblxuICAgIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29udGV4dC5ub3RDbGFzc0NhY2hlLmFkZChjYW5kaWRhdGUpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgY29udGV4dC5hcHBseUNsYXNzQ2FjaGUuc2V0KGNhbmRpZGF0ZSwgbWF0Y2hlcyk7XG4gIH1cblxuICByZXR1cm4gY29udGV4dC5hcHBseUNsYXNzQ2FjaGU7XG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RBcHBseUNhbmRpZGF0ZXMocGFyYW1zKSB7XG4gIGxldCBjYW5kaWRhdGVzID0gcGFyYW1zLnNwbGl0KC9bXFxzXFx0XFxuXSsvZyk7XG5cbiAgaWYgKGNhbmRpZGF0ZXNbY2FuZGlkYXRlcy5sZW5ndGggLSAxXSA9PT0gJyFpbXBvcnRhbnQnKSB7XG4gICAgcmV0dXJuIFtjYW5kaWRhdGVzLnNsaWNlKDAsIC0xKSwgdHJ1ZV07XG4gIH1cblxuICByZXR1cm4gW2NhbmRpZGF0ZXMsIGZhbHNlXTtcbn1cblxuZnVuY3Rpb24gcGFydGl0aW9uQXBwbHlQYXJlbnRzKHJvb3QpIHtcbiAgbGV0IGFwcGx5UGFyZW50cyA9IG5ldyBTZXQoKTtcbiAgcm9vdC53YWxrQXRSdWxlcygnYXBwbHknLCBydWxlID0+IHtcbiAgICBhcHBseVBhcmVudHMuYWRkKHJ1bGUucGFyZW50KTtcbiAgfSk7XG5cbiAgZm9yIChsZXQgcnVsZSBvZiBhcHBseVBhcmVudHMpIHtcbiAgICBsZXQgbm9kZUdyb3VwcyA9IFtdO1xuICAgIGxldCBsYXN0R3JvdXAgPSBbXTtcblxuICAgIGZvciAobGV0IG5vZGUgb2YgcnVsZS5ub2Rlcykge1xuICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2F0cnVsZScgJiYgbm9kZS5uYW1lID09PSAnYXBwbHknKSB7XG4gICAgICAgIGlmIChsYXN0R3JvdXAubGVuZ3RoID4gMCkge1xuICAgICAgICAgIG5vZGVHcm91cHMucHVzaChsYXN0R3JvdXApO1xuICAgICAgICAgIGxhc3RHcm91cCA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZUdyb3Vwcy5wdXNoKFtub2RlXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsYXN0R3JvdXAucHVzaChub2RlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobGFzdEdyb3VwLmxlbmd0aCA+IDApIHtcbiAgICAgIG5vZGVHcm91cHMucHVzaChsYXN0R3JvdXApO1xuICAgIH1cblxuICAgIGlmIChub2RlR3JvdXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgZ3JvdXAgb2YgWy4uLm5vZGVHcm91cHNdLnJldmVyc2UoKSkge1xuICAgICAgbGV0IG5ld1BhcmVudCA9IHJ1bGUuY2xvbmUoe1xuICAgICAgICBub2RlczogW11cbiAgICAgIH0pO1xuICAgICAgbmV3UGFyZW50LmFwcGVuZChncm91cCk7XG4gICAgICBydWxlLmFmdGVyKG5ld1BhcmVudCk7XG4gICAgfVxuXG4gICAgcnVsZS5yZW1vdmUoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcm9jZXNzQXBwbHkocm9vdCwgY29udGV4dCkge1xuICBsZXQgYXBwbHlDYW5kaWRhdGVzID0gbmV3IFNldCgpOyAvLyBDb2xsZWN0IGFsbCBAYXBwbHkgcnVsZXMgYW5kIGNhbmRpZGF0ZXNcblxuICBsZXQgYXBwbGllcyA9IFtdO1xuICByb290LndhbGtBdFJ1bGVzKCdhcHBseScsIHJ1bGUgPT4ge1xuICAgIGxldCBbY2FuZGlkYXRlc10gPSBleHRyYWN0QXBwbHlDYW5kaWRhdGVzKHJ1bGUucGFyYW1zKTtcblxuICAgIGZvciAobGV0IHV0aWwgb2YgY2FuZGlkYXRlcykge1xuICAgICAgYXBwbHlDYW5kaWRhdGVzLmFkZCh1dGlsKTtcbiAgICB9XG5cbiAgICBhcHBsaWVzLnB1c2gocnVsZSk7XG4gIH0pOyAvLyBTdGFydCB0aGUgQGFwcGx5IHByb2Nlc3MgaWYgd2UgaGF2ZSBydWxlcyB3aXRoIEBhcHBseSBpbiB0aGVtXG5cbiAgaWYgKGFwcGxpZXMubGVuZ3RoID4gMCkge1xuICAgIC8vIEZpbGwgdXAgc29tZSBjYWNoZXMhXG4gICAgbGV0IGFwcGx5Q2xhc3NDYWNoZSA9IGJ1aWxkQXBwbHlDYWNoZShhcHBseUNhbmRpZGF0ZXMsIGNvbnRleHQpO1xuICAgIC8qKlxuICAgICAqIFdoZW4gd2UgaGF2ZSBhbiBhcHBseSBsaWtlIHRoaXM6XG4gICAgICpcbiAgICAgKiAuYWJjIHtcbiAgICAgKiAgICBAYXBwbHkgaG92ZXI6Zm9udC1ib2xkO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIFdoYXQgd2UgZXNzZW50aWFsbHkgd2lsbCBkbyBpcyByZXNvbHZlIHRvIHRoaXM6XG4gICAgICpcbiAgICAgKiAuYWJjIHtcbiAgICAgKiAgICBAYXBwbHkgLmhvdmVyXFw6Zm9udC1ib2xkOmhvdmVyIHtcbiAgICAgKiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICogICAgfVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIE5vdGljZSB0aGF0IHRoZSB0by1iZS1hcHBsaWVkIGNsYXNzIGlzIGAuaG92ZXJcXDpmb250LWJvbGQ6aG92ZXJgIGFuZCB0aGF0IHRoZSB1dGlsaXR5IGNhbmRpZGF0ZSB3YXMgYGhvdmVyOmZvbnQtYm9sZGAuXG4gICAgICogV2hhdCBoYXBwZW5zIGluIHRoaXMgZnVuY3Rpb24gaXMgdGhhdCB3ZSBwcmVwZW5kIGEgYC5gIGFuZCBlc2NhcGUgdGhlIGNhbmRpZGF0ZS5cbiAgICAgKiBUaGlzIHdpbGwgcmVzdWx0IGluIGAuaG92ZXJcXDpmb250LWJvbGRgXG4gICAgICogV2hpY2ggbWVhbnMgdGhhdCB3ZSBjYW4gcmVwbGFjZSBgLmhvdmVyXFw6Zm9udC1ib2xkYCB3aXRoIGAuYWJjYCBpbiBgLmhvdmVyXFw6Zm9udC1ib2xkOmhvdmVyYCByZXN1bHRpbmcgaW4gYC5hYmM6aG92ZXJgXG4gICAgICovXG4gICAgLy8gVE9ETzogU2hvdWxkIHdlIHVzZSBwb3N0Y3NzLXNlbGVjdG9yLXBhcnNlciBmb3IgdGhpcyBpbnN0ZWFkP1xuXG4gICAgZnVuY3Rpb24gcmVwbGFjZVNlbGVjdG9yKHNlbGVjdG9yLCB1dGlsaXR5U2VsZWN0b3JzLCBjYW5kaWRhdGUpIHtcbiAgICAgIGxldCBuZWVkbGUgPSBgLiR7KDAsIF9lc2NhcGVDbGFzc05hbWUuZGVmYXVsdCkoY2FuZGlkYXRlKX1gO1xuICAgICAgbGV0IHV0aWxpdHlTZWxlY3RvcnNMaXN0ID0gdXRpbGl0eVNlbGVjdG9ycy5zcGxpdCgvXFxzKixcXHMqL2cpO1xuICAgICAgcmV0dXJuIHNlbGVjdG9yLnNwbGl0KC9cXHMqLFxccyovZykubWFwKHMgPT4ge1xuICAgICAgICBsZXQgcmVwbGFjZWQgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCB1dGlsaXR5U2VsZWN0b3Igb2YgdXRpbGl0eVNlbGVjdG9yc0xpc3QpIHtcbiAgICAgICAgICBsZXQgcmVwbGFjZWRTZWxlY3RvciA9IHV0aWxpdHlTZWxlY3Rvci5yZXBsYWNlKG5lZWRsZSwgcyk7XG5cbiAgICAgICAgICBpZiAocmVwbGFjZWRTZWxlY3RvciA9PT0gdXRpbGl0eVNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXBsYWNlZC5wdXNoKHJlcGxhY2VkU2VsZWN0b3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlcGxhY2VkLmpvaW4oJywgJyk7XG4gICAgICB9KS5qb2luKCcsICcpO1xuICAgIH1cblxuICAgIGxldCBwZXJQYXJlbnRBcHBsaWVzID0gbmV3IE1hcCgpOyAvLyBDb2xsZWN0IGFsbCBhcHBseSBjYW5kaWRhdGVzIGFuZCB0aGVpciBydWxlc1xuXG4gICAgZm9yIChsZXQgYXBwbHkgb2YgYXBwbGllcykge1xuICAgICAgbGV0IGNhbmRpZGF0ZXMgPSBwZXJQYXJlbnRBcHBsaWVzLmdldChhcHBseS5wYXJlbnQpIHx8IFtdO1xuICAgICAgcGVyUGFyZW50QXBwbGllcy5zZXQoYXBwbHkucGFyZW50LCBjYW5kaWRhdGVzKTtcbiAgICAgIGxldCBbYXBwbHlDYW5kaWRhdGVzLCBpbXBvcnRhbnRdID0gZXh0cmFjdEFwcGx5Q2FuZGlkYXRlcyhhcHBseS5wYXJhbXMpO1xuXG4gICAgICBpZiAoYXBwbHkucGFyZW50LnR5cGUgPT09ICdhdHJ1bGUnKSB7XG4gICAgICAgIGlmIChhcHBseS5wYXJlbnQubmFtZSA9PT0gJ3NjcmVlbicpIHtcbiAgICAgICAgICBjb25zdCBzY3JlZW5UeXBlID0gYXBwbHkucGFyZW50LnBhcmFtcztcbiAgICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgQGFwcGx5IGlzIG5vdCBzdXBwb3J0ZWQgd2l0aGluIG5lc3RlZCBhdC1ydWxlcyBsaWtlIEBzY3JlZW4uIFdlIHN1Z2dlc3QgeW91IHdyaXRlIHRoaXMgYXMgQGFwcGx5ICR7YXBwbHlDYW5kaWRhdGVzLm1hcChjID0+IGAke3NjcmVlblR5cGV9OiR7Y31gKS5qb2luKCcgJyl9IGluc3RlYWQuYCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgQGFwcGx5IGlzIG5vdCBzdXBwb3J0ZWQgd2l0aGluIG5lc3RlZCBhdC1ydWxlcyBsaWtlIEAke2FwcGx5LnBhcmVudC5uYW1lfS4gWW91IGNhbiBmaXggdGhpcyBieSB1bi1uZXN0aW5nIEAke2FwcGx5LnBhcmVudC5uYW1lfS5gKTtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgYXBwbHlDYW5kaWRhdGUgb2YgYXBwbHlDYW5kaWRhdGVzKSB7XG4gICAgICAgIGlmICghYXBwbHlDbGFzc0NhY2hlLmhhcyhhcHBseUNhbmRpZGF0ZSkpIHtcbiAgICAgICAgICB0aHJvdyBhcHBseS5lcnJvcihgVGhlIFxcYCR7YXBwbHlDYW5kaWRhdGV9XFxgIGNsYXNzIGRvZXMgbm90IGV4aXN0LiBJZiBcXGAke2FwcGx5Q2FuZGlkYXRlfVxcYCBpcyBhIGN1c3RvbSBjbGFzcywgbWFrZSBzdXJlIGl0IGlzIGRlZmluZWQgd2l0aGluIGEgXFxgQGxheWVyXFxgIGRpcmVjdGl2ZS5gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBydWxlcyA9IGFwcGx5Q2xhc3NDYWNoZS5nZXQoYXBwbHlDYW5kaWRhdGUpO1xuICAgICAgICBjYW5kaWRhdGVzLnB1c2goW2FwcGx5Q2FuZGlkYXRlLCBpbXBvcnRhbnQsIHJ1bGVzXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBbcGFyZW50LCBjYW5kaWRhdGVzXSBvZiBwZXJQYXJlbnRBcHBsaWVzKSB7XG4gICAgICBsZXQgc2libGluZ3MgPSBbXTtcblxuICAgICAgZm9yIChsZXQgW2FwcGx5Q2FuZGlkYXRlLCBpbXBvcnRhbnQsIHJ1bGVzXSBvZiBjYW5kaWRhdGVzKSB7XG4gICAgICAgIGZvciAobGV0IFttZXRhLCBub2RlXSBvZiBydWxlcykge1xuICAgICAgICAgIGxldCByb290ID0gX3Bvc3Rjc3MuZGVmYXVsdC5yb290KHtcbiAgICAgICAgICAgIG5vZGVzOiBbbm9kZS5jbG9uZSgpXVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgbGV0IGNhblJld3JpdGVTZWxlY3RvciA9IG5vZGUudHlwZSAhPT0gJ2F0cnVsZScgfHwgbm9kZS50eXBlID09PSAnYXRydWxlJyAmJiBub2RlLm5hbWUgIT09ICdrZXlmcmFtZXMnO1xuXG4gICAgICAgICAgaWYgKGNhblJld3JpdGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgcm9vdC53YWxrUnVsZXMocnVsZSA9PiB7XG4gICAgICAgICAgICAgIHJ1bGUuc2VsZWN0b3IgPSByZXBsYWNlU2VsZWN0b3IocGFyZW50LnNlbGVjdG9yLCBydWxlLnNlbGVjdG9yLCBhcHBseUNhbmRpZGF0ZSk7XG4gICAgICAgICAgICAgIHJ1bGUud2Fsa0RlY2xzKGQgPT4ge1xuICAgICAgICAgICAgICAgIGQuaW1wb3J0YW50ID0gbWV0YS5pbXBvcnRhbnQgfHwgaW1wb3J0YW50O1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNpYmxpbmdzLnB1c2goW21ldGEsIHJvb3Qubm9kZXNbMF1dKTtcbiAgICAgICAgfVxuICAgICAgfSAvLyBJbmplY3QgdGhlIHJ1bGVzLCBzb3J0ZWQsIGNvcnJlY3RseVxuXG5cbiAgICAgIGxldCBub2RlcyA9IHNpYmxpbmdzLnNvcnQoKFthXSwgW3pdKSA9PiAoMCwgX2JpZ1NpZ24uZGVmYXVsdCkoYS5zb3J0IC0gei5zb3J0KSkubWFwKHMgPT4gc1sxXSk7IC8vIGNvbnNvbGUubG9nKHBhcmVudClcbiAgICAgIC8vIGBwYXJlbnRgIHJlZmVycyB0byB0aGUgbm9kZSBhdCBgLmFiY2AgaW46IC5hYmMgeyBAYXBwbHkgbXQtMiB9XG5cbiAgICAgIHBhcmVudC5hZnRlcihub2Rlcyk7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgYXBwbHkgb2YgYXBwbGllcykge1xuICAgICAgLy8gSWYgdGhlcmUgYXJlIGxlZnQtb3ZlciBkZWNsYXJhdGlvbnMsIGp1c3QgcmVtb3ZlIHRoZSBAYXBwbHlcbiAgICAgIGlmIChhcHBseS5wYXJlbnQubm9kZXMubGVuZ3RoID4gMSkge1xuICAgICAgICBhcHBseS5yZW1vdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRoZSBub2RlIGlzIGVtcHR5LCBkcm9wIHRoZSBmdWxsIG5vZGVcbiAgICAgICAgYXBwbHkucGFyZW50LnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH0gLy8gRG8gaXQgYWdhaW4sIGluIGNhc2Ugd2UgaGF2ZSBvdGhlciBgQGFwcGx5YCBydWxlc1xuXG5cbiAgICBwcm9jZXNzQXBwbHkocm9vdCwgY29udGV4dCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZXhwYW5kQXBwbHlBdFJ1bGVzKGNvbnRleHQpIHtcbiAgcmV0dXJuIHJvb3QgPT4ge1xuICAgIHBhcnRpdGlvbkFwcGx5UGFyZW50cyhyb290KTtcbiAgICBwcm9jZXNzQXBwbHkocm9vdCwgY29udGV4dCk7XG4gIH07XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnJlc29sdmVNYXRjaGVzID0gcmVzb2x2ZU1hdGNoZXM7XG5leHBvcnRzLmdlbmVyYXRlUnVsZXMgPSBnZW5lcmF0ZVJ1bGVzO1xuXG52YXIgX3Bvc3Rjc3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJwb3N0Y3NzXCIpKTtcblxudmFyIF9wb3N0Y3NzU2VsZWN0b3JQYXJzZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJwb3N0Y3NzLXNlbGVjdG9yLXBhcnNlclwiKSk7XG5cbnZhciBfcGFyc2VPYmplY3RTdHlsZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi8uLi91dGlsL3BhcnNlT2JqZWN0U3R5bGVzXCIpKTtcblxudmFyIF9pc1BsYWluT2JqZWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vdXRpbC9pc1BsYWluT2JqZWN0XCIpKTtcblxudmFyIF9wcmVmaXhTZWxlY3RvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL3V0aWwvcHJlZml4U2VsZWN0b3JcIikpO1xuXG52YXIgX3BsdWdpblV0aWxzID0gcmVxdWlyZShcIi4uLy4uL3V0aWwvcGx1Z2luVXRpbHNcIik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmxldCBjbGFzc05hbWVQYXJzZXIgPSAoMCwgX3Bvc3Rjc3NTZWxlY3RvclBhcnNlci5kZWZhdWx0KShzZWxlY3RvcnMgPT4ge1xuICByZXR1cm4gc2VsZWN0b3JzLmZpcnN0LmZpbHRlcigoe1xuICAgIHR5cGVcbiAgfSkgPT4gdHlwZSA9PT0gJ2NsYXNzJykucG9wKCkudmFsdWU7XG59KTtcblxuZnVuY3Rpb24gZ2V0Q2xhc3NOYW1lRnJvbVNlbGVjdG9yKHNlbGVjdG9yKSB7XG4gIHJldHVybiBjbGFzc05hbWVQYXJzZXIudHJhbnNmb3JtU3luYyhzZWxlY3Rvcik7XG59IC8vIEdlbmVyYXRlIG1hdGNoIHBlcm11dGF0aW9ucyBmb3IgYSBjbGFzcyBjYW5kaWRhdGUsIGxpa2U6XG4vLyBbJ3Jpbmctb2Zmc2V0LWJsdWUnLCAnMTAwJ11cbi8vIFsncmluZy1vZmZzZXQnLCAnYmx1ZS0xMDAnXVxuLy8gWydyaW5nJywgJ29mZnNldC1ibHVlLTEwMCddXG4vLyBFeGFtcGxlIHdpdGggZHluYW1pYyBjbGFzc2VzOlxuLy8gWydncmlkLWNvbHMnLCAnW1tsaW5lbmFtZV0sMWZyLGF1dG9dJ11cbi8vIFsnZ3JpZCcsICdjb2xzLVtbbGluZW5hbWVdLDFmcixhdXRvXSddXG5cblxuZnVuY3Rpb24qIGNhbmRpZGF0ZVBlcm11dGF0aW9ucyhjYW5kaWRhdGUsIGxhc3RJbmRleCA9IEluZmluaXR5KSB7XG4gIGlmIChsYXN0SW5kZXggPCAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGRhc2hJZHg7XG5cbiAgaWYgKGxhc3RJbmRleCA9PT0gSW5maW5pdHkgJiYgY2FuZGlkYXRlLmVuZHNXaXRoKCddJykpIHtcbiAgICBsZXQgYnJhY2tldElkeCA9IGNhbmRpZGF0ZS5pbmRleE9mKCdbJyk7IC8vIElmIGNoYXJhY3RlciBiZWZvcmUgYFtgIGlzbid0IGEgZGFzaCBvciBhIHNsYXNoLCB0aGlzIGlzbid0IGEgZHluYW1pYyBjbGFzc1xuICAgIC8vIGVnLiBzdHJpbmdbXVxuXG4gICAgZGFzaElkeCA9IFsnLScsICcvJ10uaW5jbHVkZXMoY2FuZGlkYXRlW2JyYWNrZXRJZHggLSAxXSkgPyBicmFja2V0SWR4IC0gMSA6IC0xO1xuICB9IGVsc2Uge1xuICAgIGRhc2hJZHggPSBjYW5kaWRhdGUubGFzdEluZGV4T2YoJy0nLCBsYXN0SW5kZXgpO1xuICB9XG5cbiAgaWYgKGRhc2hJZHggPCAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHByZWZpeCA9IGNhbmRpZGF0ZS5zbGljZSgwLCBkYXNoSWR4KTtcbiAgbGV0IG1vZGlmaWVyID0gY2FuZGlkYXRlLnNsaWNlKGRhc2hJZHggKyAxKTtcbiAgeWllbGQgW3ByZWZpeCwgbW9kaWZpZXJdO1xuICB5aWVsZCogY2FuZGlkYXRlUGVybXV0YXRpb25zKGNhbmRpZGF0ZSwgZGFzaElkeCAtIDEpO1xufVxuXG5mdW5jdGlvbiBhcHBseVByZWZpeChtYXRjaGVzLCBjb250ZXh0KSB7XG4gIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCB8fCBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnByZWZpeCA9PT0gJycpIHtcbiAgICByZXR1cm4gbWF0Y2hlcztcbiAgfVxuXG4gIGZvciAobGV0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICBsZXQgW21ldGFdID0gbWF0Y2g7XG5cbiAgICBpZiAobWV0YS5vcHRpb25zLnJlc3BlY3RQcmVmaXgpIHtcbiAgICAgIGxldCBjb250YWluZXIgPSBfcG9zdGNzcy5kZWZhdWx0LnJvb3Qoe1xuICAgICAgICBub2RlczogW21hdGNoWzFdLmNsb25lKCldXG4gICAgICB9KTtcblxuICAgICAgY29udGFpbmVyLndhbGtSdWxlcyhyID0+IHtcbiAgICAgICAgci5zZWxlY3RvciA9ICgwLCBfcHJlZml4U2VsZWN0b3IuZGVmYXVsdCkoY29udGV4dC50YWlsd2luZENvbmZpZy5wcmVmaXgsIHIuc2VsZWN0b3IpO1xuICAgICAgfSk7XG4gICAgICBtYXRjaFsxXSA9IGNvbnRhaW5lci5ub2Rlc1swXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWF0Y2hlcztcbn1cblxuZnVuY3Rpb24gYXBwbHlJbXBvcnRhbnQobWF0Y2hlcykge1xuICBpZiAobWF0Y2hlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbWF0Y2hlcztcbiAgfVxuXG4gIGxldCByZXN1bHQgPSBbXTtcblxuICBmb3IgKGxldCBbbWV0YSwgcnVsZV0gb2YgbWF0Y2hlcykge1xuICAgIGxldCBjb250YWluZXIgPSBfcG9zdGNzcy5kZWZhdWx0LnJvb3Qoe1xuICAgICAgbm9kZXM6IFtydWxlLmNsb25lKCldXG4gICAgfSk7XG5cbiAgICBjb250YWluZXIud2Fsa1J1bGVzKHIgPT4ge1xuICAgICAgci5zZWxlY3RvciA9ICgwLCBfcGx1Z2luVXRpbHMudXBkYXRlQWxsQ2xhc3Nlcykoci5zZWxlY3RvciwgY2xhc3NOYW1lID0+IHtcbiAgICAgICAgcmV0dXJuIGAhJHtjbGFzc05hbWV9YDtcbiAgICAgIH0pO1xuICAgICAgci53YWxrRGVjbHMoZCA9PiBkLmltcG9ydGFudCA9IHRydWUpO1xuICAgIH0pO1xuICAgIHJlc3VsdC5wdXNoKFt7IC4uLm1ldGEsXG4gICAgICBpbXBvcnRhbnQ6IHRydWVcbiAgICB9LCBjb250YWluZXIubm9kZXNbMF1dKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59IC8vIFRha2VzIGEgbGlzdCBvZiBydWxlIHR1cGxlcyBhbmQgYXBwbGllcyBhIHZhcmlhbnQgbGlrZSBgaG92ZXJgLCBzbWAsXG4vLyB3aGF0ZXZlciB0byBpdC4gV2UgdXNlZCB0byBkbyBzb21lIGV4dHJhIGNhY2hpbmcgaGVyZSB0byBhdm9pZCBnZW5lcmF0aW5nXG4vLyBhIHZhcmlhbnQgb2YgdGhlIHNhbWUgcnVsZSBtb3JlIHRoYW4gb25jZSwgYnV0IHRoaXMgd2FzIG5ldmVyIGhpdCBiZWNhdXNlXG4vLyB3ZSBjYWNoZSBhdCB0aGUgZW50aXJlIHNlbGVjdG9yIGxldmVsIGZ1cnRoZXIgdXAgdGhlIHRyZWUuXG4vL1xuLy8gVGVjaG5pY2FsbHkgeW91IGNhbiBnZXQgYSBjYWNoZSBoaXQgaWYgeW91IGhhdmUgYGhvdmVyOmZvY3VzOnRleHQtY2VudGVyYFxuLy8gYW5kIGBmb2N1czpob3Zlcjp0ZXh0LWNlbnRlcmAgaW4gdGhlIHNhbWUgcHJvamVjdCwgYnV0IGl0IGRvZXNuJ3QgZmVlbFxuLy8gd29ydGggdGhlIGNvbXBsZXhpdHkgZm9yIHRoYXQgY2FzZS5cblxuXG5mdW5jdGlvbiBhcHBseVZhcmlhbnQodmFyaWFudCwgbWF0Y2hlcywgY29udGV4dCkge1xuICBpZiAobWF0Y2hlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbWF0Y2hlcztcbiAgfVxuXG4gIGlmIChjb250ZXh0LnZhcmlhbnRNYXAuaGFzKHZhcmlhbnQpKSB7XG4gICAgbGV0IHZhcmlhbnRGdW5jdGlvblR1cGxlcyA9IGNvbnRleHQudmFyaWFudE1hcC5nZXQodmFyaWFudCk7XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuXG4gICAgZm9yIChsZXQgW21ldGEsIHJ1bGVdIG9mIG1hdGNoZXMpIHtcbiAgICAgIGlmIChtZXRhLm9wdGlvbnMucmVzcGVjdFZhcmlhbnRzID09PSBmYWxzZSkge1xuICAgICAgICByZXN1bHQucHVzaChbbWV0YSwgcnVsZV0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbGV0IGNvbnRhaW5lciA9IF9wb3N0Y3NzLmRlZmF1bHQucm9vdCh7XG4gICAgICAgIG5vZGVzOiBbcnVsZS5jbG9uZSgpXVxuICAgICAgfSk7XG5cbiAgICAgIGZvciAobGV0IFt2YXJpYW50U29ydCwgdmFyaWFudEZ1bmN0aW9uXSBvZiB2YXJpYW50RnVuY3Rpb25UdXBsZXMpIHtcbiAgICAgICAgbGV0IGNsb25lID0gY29udGFpbmVyLmNsb25lKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gbW9kaWZ5U2VsZWN0b3JzKG1vZGlmaWVyRnVuY3Rpb24pIHtcbiAgICAgICAgICBjbG9uZS5lYWNoKHJ1bGUgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bGUudHlwZSAhPT0gJ3J1bGUnKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcnVsZS5zZWxlY3RvcnMgPSBydWxlLnNlbGVjdG9ycy5tYXAoc2VsZWN0b3IgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXJGdW5jdGlvbih7XG4gICAgICAgICAgICAgICAgZ2V0IGNsYXNzTmFtZSgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDbGFzc05hbWVGcm9tU2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBzZWxlY3RvclxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBydWxlV2l0aFZhcmlhbnQgPSB2YXJpYW50RnVuY3Rpb24oe1xuICAgICAgICAgIGNvbnRhaW5lcjogY2xvbmUsXG4gICAgICAgICAgc2VwYXJhdG9yOiBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnNlcGFyYXRvcixcbiAgICAgICAgICBtb2RpZnlTZWxlY3RvcnNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHJ1bGVXaXRoVmFyaWFudCA9PT0gbnVsbCkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHdpdGhPZmZzZXQgPSBbeyAuLi5tZXRhLFxuICAgICAgICAgIHNvcnQ6IHZhcmlhbnRTb3J0IHwgbWV0YS5zb3J0XG4gICAgICAgIH0sIGNsb25lLm5vZGVzWzBdXTtcbiAgICAgICAgcmVzdWx0LnB1c2god2l0aE9mZnNldCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiBbXTtcbn1cblxuZnVuY3Rpb24gcGFyc2VSdWxlcyhydWxlLCBjYWNoZSwgb3B0aW9ucyA9IHt9KSB7XG4gIC8vIFBvc3RDU1Mgbm9kZVxuICBpZiAoISgwLCBfaXNQbGFpbk9iamVjdC5kZWZhdWx0KShydWxlKSAmJiAhQXJyYXkuaXNBcnJheShydWxlKSkge1xuICAgIHJldHVybiBbW3J1bGVdLCBvcHRpb25zXTtcbiAgfSAvLyBUdXBsZVxuXG5cbiAgaWYgKEFycmF5LmlzQXJyYXkocnVsZSkpIHtcbiAgICByZXR1cm4gcGFyc2VSdWxlcyhydWxlWzBdLCBjYWNoZSwgcnVsZVsxXSk7XG4gIH0gLy8gU2ltcGxlIG9iamVjdFxuXG5cbiAgaWYgKCFjYWNoZS5oYXMocnVsZSkpIHtcbiAgICBjYWNoZS5zZXQocnVsZSwgKDAsIF9wYXJzZU9iamVjdFN0eWxlcy5kZWZhdWx0KShydWxlKSk7XG4gIH1cblxuICByZXR1cm4gW2NhY2hlLmdldChydWxlKSwgb3B0aW9uc107XG59XG5cbmZ1bmN0aW9uKiByZXNvbHZlTWF0Y2hlZFBsdWdpbnMoY2xhc3NDYW5kaWRhdGUsIGNvbnRleHQpIHtcbiAgaWYgKGNvbnRleHQuY2FuZGlkYXRlUnVsZU1hcC5oYXMoY2xhc3NDYW5kaWRhdGUpKSB7XG4gICAgeWllbGQgW2NvbnRleHQuY2FuZGlkYXRlUnVsZU1hcC5nZXQoY2xhc3NDYW5kaWRhdGUpLCAnREVGQVVMVCddO1xuICB9XG5cbiAgbGV0IGNhbmRpZGF0ZVByZWZpeCA9IGNsYXNzQ2FuZGlkYXRlO1xuICBsZXQgbmVnYXRpdmUgPSBmYWxzZTtcbiAgY29uc3QgdHdDb25maWdQcmVmaXggPSBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnByZWZpeCB8fCAnJztcbiAgY29uc3QgdHdDb25maWdQcmVmaXhMZW4gPSB0d0NvbmZpZ1ByZWZpeC5sZW5ndGg7XG5cbiAgaWYgKGNhbmRpZGF0ZVByZWZpeFt0d0NvbmZpZ1ByZWZpeExlbl0gPT09ICctJykge1xuICAgIG5lZ2F0aXZlID0gdHJ1ZTtcbiAgICBjYW5kaWRhdGVQcmVmaXggPSB0d0NvbmZpZ1ByZWZpeCArIGNhbmRpZGF0ZVByZWZpeC5zbGljZSh0d0NvbmZpZ1ByZWZpeExlbiArIDEpO1xuICB9XG5cbiAgZm9yIChsZXQgW3ByZWZpeCwgbW9kaWZpZXJdIG9mIGNhbmRpZGF0ZVBlcm11dGF0aW9ucyhjYW5kaWRhdGVQcmVmaXgpKSB7XG4gICAgaWYgKGNvbnRleHQuY2FuZGlkYXRlUnVsZU1hcC5oYXMocHJlZml4KSkge1xuICAgICAgeWllbGQgW2NvbnRleHQuY2FuZGlkYXRlUnVsZU1hcC5nZXQocHJlZml4KSwgbmVnYXRpdmUgPyBgLSR7bW9kaWZpZXJ9YCA6IG1vZGlmaWVyXTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc3BsaXRXaXRoU2VwYXJhdG9yKGlucHV0LCBzZXBhcmF0b3IpIHtcbiAgcmV0dXJuIGlucHV0LnNwbGl0KG5ldyBSZWdFeHAoYFxcXFwke3NlcGFyYXRvcn0oPyFbXltdKlxcXFxdKWAsICdnJykpO1xufVxuXG5mdW5jdGlvbiogcmVzb2x2ZU1hdGNoZXMoY2FuZGlkYXRlLCBjb250ZXh0KSB7XG4gIGxldCBzZXBhcmF0b3IgPSBjb250ZXh0LnRhaWx3aW5kQ29uZmlnLnNlcGFyYXRvcjtcbiAgbGV0IFtjbGFzc0NhbmRpZGF0ZSwgLi4udmFyaWFudHNdID0gc3BsaXRXaXRoU2VwYXJhdG9yKGNhbmRpZGF0ZSwgc2VwYXJhdG9yKS5yZXZlcnNlKCk7XG4gIGxldCBpbXBvcnRhbnQgPSBmYWxzZTtcblxuICBpZiAoY2xhc3NDYW5kaWRhdGUuc3RhcnRzV2l0aCgnIScpKSB7XG4gICAgaW1wb3J0YW50ID0gdHJ1ZTtcbiAgICBjbGFzc0NhbmRpZGF0ZSA9IGNsYXNzQ2FuZGlkYXRlLnNsaWNlKDEpO1xuICB9IC8vIFRPRE86IFJlaW50cm9kdWNlIHRoaXMgaW4gd2F5cyB0aGF0IGRvZXNuJ3QgYnJlYWsgb24gZmFsc2UgcG9zaXRpdmVzXG4gIC8vIGZ1bmN0aW9uIHNvcnRBZ2FpbnN0KHRvU29ydCwgYWdhaW5zdCkge1xuICAvLyAgIHJldHVybiB0b1NvcnQuc2xpY2UoKS5zb3J0KChhLCB6KSA9PiB7XG4gIC8vICAgICByZXR1cm4gYmlnU2lnbihhZ2FpbnN0LmdldChhKVswXSAtIGFnYWluc3QuZ2V0KHopWzBdKVxuICAvLyAgIH0pXG4gIC8vIH1cbiAgLy8gbGV0IHNvcnRlZCA9IHNvcnRBZ2FpbnN0KHZhcmlhbnRzLCBjb250ZXh0LnZhcmlhbnRNYXApXG4gIC8vIGlmIChzb3J0ZWQudG9TdHJpbmcoKSAhPT0gdmFyaWFudHMudG9TdHJpbmcoKSkge1xuICAvLyAgIGxldCBjb3JyZWN0ZWQgPSBzb3J0ZWQucmV2ZXJzZSgpLmNvbmNhdChjbGFzc0NhbmRpZGF0ZSkuam9pbignOicpXG4gIC8vICAgdGhyb3cgbmV3IEVycm9yKGBDbGFzcyAke2NhbmRpZGF0ZX0gc2hvdWxkIGJlIHdyaXR0ZW4gYXMgJHtjb3JyZWN0ZWR9YClcbiAgLy8gfVxuXG5cbiAgZm9yIChsZXQgbWF0Y2hlZFBsdWdpbnMgb2YgcmVzb2x2ZU1hdGNoZWRQbHVnaW5zKGNsYXNzQ2FuZGlkYXRlLCBjb250ZXh0KSkge1xuICAgIGxldCBtYXRjaGVzID0gW107XG4gICAgbGV0IFtwbHVnaW5zLCBtb2RpZmllcl0gPSBtYXRjaGVkUGx1Z2lucztcblxuICAgIGZvciAobGV0IFtzb3J0LCBwbHVnaW5dIG9mIHBsdWdpbnMpIHtcbiAgICAgIGlmICh0eXBlb2YgcGx1Z2luID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGZvciAobGV0IHJ1bGVTZXQgb2YgW10uY29uY2F0KHBsdWdpbihtb2RpZmllcikpKSB7XG4gICAgICAgICAgbGV0IFtydWxlcywgb3B0aW9uc10gPSBwYXJzZVJ1bGVzKHJ1bGVTZXQsIGNvbnRleHQucG9zdENzc05vZGVDYWNoZSk7XG5cbiAgICAgICAgICBmb3IgKGxldCBydWxlIG9mIHJ1bGVzKSB7XG4gICAgICAgICAgICBtYXRjaGVzLnB1c2goW3sgLi4uc29ydCxcbiAgICAgICAgICAgICAgb3B0aW9uczogeyAuLi5zb3J0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBydWxlXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IC8vIE9ubHkgcHJvY2VzcyBzdGF0aWMgcGx1Z2lucyBvbiBleGFjdCBtYXRjaGVzXG4gICAgICBlbHNlIGlmIChtb2RpZmllciA9PT0gJ0RFRkFVTFQnKSB7XG4gICAgICAgIGxldCBydWxlU2V0ID0gcGx1Z2luO1xuICAgICAgICBsZXQgW3J1bGVzLCBvcHRpb25zXSA9IHBhcnNlUnVsZXMocnVsZVNldCwgY29udGV4dC5wb3N0Q3NzTm9kZUNhY2hlKTtcblxuICAgICAgICBmb3IgKGxldCBydWxlIG9mIHJ1bGVzKSB7XG4gICAgICAgICAgbWF0Y2hlcy5wdXNoKFt7IC4uLnNvcnQsXG4gICAgICAgICAgICBvcHRpb25zOiB7IC4uLnNvcnQub3B0aW9ucyxcbiAgICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIHJ1bGVdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIG1hdGNoZXMgPSBhcHBseVByZWZpeChtYXRjaGVzLCBjb250ZXh0KTtcblxuICAgIGlmIChpbXBvcnRhbnQpIHtcbiAgICAgIG1hdGNoZXMgPSBhcHBseUltcG9ydGFudChtYXRjaGVzLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCB2YXJpYW50IG9mIHZhcmlhbnRzKSB7XG4gICAgICBtYXRjaGVzID0gYXBwbHlWYXJpYW50KHZhcmlhbnQsIG1hdGNoZXMsIGNvbnRleHQpO1xuICAgIH1cblxuICAgIGZvciAobGV0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICAgIHlpZWxkIG1hdGNoO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBpbktleWZyYW1lcyhydWxlKSB7XG4gIHJldHVybiBydWxlLnBhcmVudCAmJiBydWxlLnBhcmVudC50eXBlID09PSAnYXRydWxlJyAmJiBydWxlLnBhcmVudC5uYW1lID09PSAna2V5ZnJhbWVzJztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVSdWxlcyhjYW5kaWRhdGVzLCBjb250ZXh0KSB7XG4gIGxldCBhbGxSdWxlcyA9IFtdO1xuXG4gIGZvciAobGV0IGNhbmRpZGF0ZSBvZiBjYW5kaWRhdGVzKSB7XG4gICAgaWYgKGNvbnRleHQubm90Q2xhc3NDYWNoZS5oYXMoY2FuZGlkYXRlKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuY2xhc3NDYWNoZS5oYXMoY2FuZGlkYXRlKSkge1xuICAgICAgYWxsUnVsZXMucHVzaChjb250ZXh0LmNsYXNzQ2FjaGUuZ2V0KGNhbmRpZGF0ZSkpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgbGV0IG1hdGNoZXMgPSBBcnJheS5mcm9tKHJlc29sdmVNYXRjaGVzKGNhbmRpZGF0ZSwgY29udGV4dCkpO1xuXG4gICAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb250ZXh0Lm5vdENsYXNzQ2FjaGUuYWRkKGNhbmRpZGF0ZSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb250ZXh0LmNsYXNzQ2FjaGUuc2V0KGNhbmRpZGF0ZSwgbWF0Y2hlcyk7XG4gICAgYWxsUnVsZXMucHVzaChtYXRjaGVzKTtcbiAgfVxuXG4gIHJldHVybiBhbGxSdWxlcy5mbGF0KDEpLm1hcCgoW3tcbiAgICBzb3J0LFxuICAgIGxheWVyLFxuICAgIG9wdGlvbnNcbiAgfSwgcnVsZV0pID0+IHtcbiAgICBpZiAob3B0aW9ucy5yZXNwZWN0SW1wb3J0YW50KSB7XG4gICAgICBpZiAoY29udGV4dC50YWlsd2luZENvbmZpZy5pbXBvcnRhbnQgPT09IHRydWUpIHtcbiAgICAgICAgcnVsZS53YWxrRGVjbHMoZCA9PiB7XG4gICAgICAgICAgaWYgKGQucGFyZW50LnR5cGUgPT09ICdydWxlJyAmJiAhaW5LZXlmcmFtZXMoZC5wYXJlbnQpKSB7XG4gICAgICAgICAgICBkLmltcG9ydGFudCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRleHQudGFpbHdpbmRDb25maWcuaW1wb3J0YW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgY29udGFpbmVyID0gX3Bvc3Rjc3MuZGVmYXVsdC5yb290KHtcbiAgICAgICAgICBub2RlczogW3J1bGUuY2xvbmUoKV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29udGFpbmVyLndhbGtSdWxlcyhyID0+IHtcbiAgICAgICAgICBpZiAoaW5LZXlmcmFtZXMocikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByLnNlbGVjdG9ycyA9IHIuc2VsZWN0b3JzLm1hcChzZWxlY3RvciA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYCR7Y29udGV4dC50YWlsd2luZENvbmZpZy5pbXBvcnRhbnR9ICR7c2VsZWN0b3J9YDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJ1bGUgPSBjb250YWluZXIubm9kZXNbMF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFtzb3J0IHwgY29udGV4dC5sYXllck9yZGVyW2xheWVyXSwgcnVsZV07XG4gIH0pO1xufSJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImNvbnRleHQiLCJyb290IiwiYXBwbHlQYXJlbnRzIiwiU2V0Iiwid2Fsa0F0UnVsZXMiLCJydWxlIiwiYWRkIiwicGFyZW50Iiwibm9kZUdyb3VwcyIsImxhc3RHcm91cCIsIm5vZGUiLCJub2RlcyIsInR5cGUiLCJuYW1lIiwibGVuZ3RoIiwicHVzaCIsImdyb3VwIiwicmV2ZXJzZSIsIm5ld1BhcmVudCIsImNsb25lIiwiYXBwZW5kIiwiYWZ0ZXIiLCJyZW1vdmUiLCJwYXJ0aXRpb25BcHBseVBhcmVudHMiLCJwcm9jZXNzQXBwbHkiLCJfcG9zdGNzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfZ2VuZXJhdGVSdWxlcyIsIl9iaWdTaWduIiwiX2VzY2FwZUNsYXNzTmFtZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZXh0cmFjdEFwcGx5Q2FuZGlkYXRlcyIsInBhcmFtcyIsImNhbmRpZGF0ZXMiLCJzcGxpdCIsInNsaWNlIiwiYXBwbHlDYW5kaWRhdGVzIiwiYXBwbGllcyIsInV0aWwiLCJhcHBseUNsYXNzQ2FjaGUiLCJjYW5kaWRhdGUiLCJub3RDbGFzc0NhY2hlIiwiaGFzIiwiY2xhc3NDYWNoZSIsInNldCIsImdldCIsIm1hcCIsIm1ldGEiLCJtYXRjaGVzIiwiQXJyYXkiLCJmcm9tIiwicmVzb2x2ZU1hdGNoZXMiLCJidWlsZEFwcGx5Q2FjaGUiLCJyZXBsYWNlU2VsZWN0b3IiLCJzZWxlY3RvciIsInV0aWxpdHlTZWxlY3RvcnMiLCJuZWVkbGUiLCJ1dGlsaXR5U2VsZWN0b3JzTGlzdCIsInMiLCJyZXBsYWNlZCIsInV0aWxpdHlTZWxlY3RvciIsInJlcGxhY2VkU2VsZWN0b3IiLCJyZXBsYWNlIiwiam9pbiIsInBlclBhcmVudEFwcGxpZXMiLCJNYXAiLCJhcHBseSIsImltcG9ydGFudCIsInNjcmVlblR5cGUiLCJlcnJvciIsImMiLCJhcHBseUNhbmRpZGF0ZSIsInJ1bGVzIiwic2libGluZ3MiLCJ3YWxrUnVsZXMiLCJ3YWxrRGVjbHMiLCJkIiwic29ydCIsImEiLCJ6IiwiZ2VuZXJhdGVSdWxlcyIsImFsbFJ1bGVzIiwiZmxhdCIsImxheWVyIiwib3B0aW9ucyIsInJlc3BlY3RJbXBvcnRhbnQiLCJ0YWlsd2luZENvbmZpZyIsImluS2V5ZnJhbWVzIiwiY29udGFpbmVyIiwiciIsInNlbGVjdG9ycyIsImxheWVyT3JkZXIiLCJfcG9zdGNzc1NlbGVjdG9yUGFyc2VyIiwiX3BhcnNlT2JqZWN0U3R5bGVzIiwiX2lzUGxhaW5PYmplY3QiLCJfcHJlZml4U2VsZWN0b3IiLCJfcGx1Z2luVXRpbHMiLCJjbGFzc05hbWVQYXJzZXIiLCJmaXJzdCIsImZpbHRlciIsInBvcCIsImdldENsYXNzTmFtZUZyb21TZWxlY3RvciIsInRyYW5zZm9ybVN5bmMiLCJjYW5kaWRhdGVQZXJtdXRhdGlvbnMiLCJsYXN0SW5kZXgiLCJJbmZpbml0eSIsImRhc2hJZHgiLCJlbmRzV2l0aCIsImJyYWNrZXRJZHgiLCJpbmRleE9mIiwiaW5jbHVkZXMiLCJsYXN0SW5kZXhPZiIsInByZWZpeCIsIm1vZGlmaWVyIiwiYXBwbHlQcmVmaXgiLCJtYXRjaCIsInJlc3BlY3RQcmVmaXgiLCJhcHBseUltcG9ydGFudCIsInJlc3VsdCIsInVwZGF0ZUFsbENsYXNzZXMiLCJjbGFzc05hbWUiLCJhcHBseVZhcmlhbnQiLCJ2YXJpYW50IiwidmFyaWFudE1hcCIsInZhcmlhbnRGdW5jdGlvblR1cGxlcyIsInJlc3BlY3RWYXJpYW50cyIsInZhcmlhbnRTb3J0IiwidmFyaWFudEZ1bmN0aW9uIiwibW9kaWZ5U2VsZWN0b3JzIiwibW9kaWZpZXJGdW5jdGlvbiIsImVhY2giLCJzZXBhcmF0b3IiLCJ3aXRoT2Zmc2V0IiwicGFyc2VSdWxlcyIsImNhY2hlIiwiaXNBcnJheSIsInJlc29sdmVNYXRjaGVkUGx1Z2lucyIsImNsYXNzQ2FuZGlkYXRlIiwiY2FuZGlkYXRlUnVsZU1hcCIsImNhbmRpZGF0ZVByZWZpeCIsIm5lZ2F0aXZlIiwidHdDb25maWdQcmVmaXgiLCJ0d0NvbmZpZ1ByZWZpeExlbiIsInZhcmlhbnRzIiwiaW5wdXQiLCJSZWdFeHAiLCJzcGxpdFdpdGhTZXBhcmF0b3IiLCJzdGFydHNXaXRoIiwibWF0Y2hlZFBsdWdpbnMiLCJwbHVnaW5zIiwicGx1Z2luIiwicnVsZVNldCIsImNvbmNhdCIsInBvc3RDc3NOb2RlQ2FjaGUiXSwic291cmNlUm9vdCI6IiJ9